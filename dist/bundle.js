(()=>{"use strict";function e(e,t,n){const r=n.value;return{configurable:!0,get(){return r.bind(this)}}}var t;!function(e){e.Active="active",e.Finished="finished"}(t||(t={}));class n{constructor(e,t,n,r,s){this.id=e,this.title=t,this.description=n,this.people=r,this.status=s}}class r extends class{constructor(){this.listeners=[]}addListener(e){this.listeners.push(e)}}{constructor(){super(),this.projects=[]}static getInstance(){return this.instance||(this.instance=new r),this.instance}addProject(e,r,s){const i=new n(Math.random().toString(),e,r,s,t.Active);this.projects.push(i);for(const e of this.listeners)e(this.projects.slice())}deleteProject(e){const t=this.projects.find((t=>t.id===e));if(t){this.projects.splice(this.projects.indexOf(t),1);for(const e of this.listeners)e(this.projects.slice())}}moveProject(e,t){const n=this.projects.find((t=>t.id===e));n&&n.status!==t&&(n.status=t,this.updateListeners())}updateListeners(){for(const e of this.listeners)e(this.projects.slice())}}const s=r.getInstance();class i{constructor(e,t,n,r){this.templateElement=document.getElementById(e),this.hostElement=document.getElementById(t);const s=document.importNode(this.templateElement.content,!0);this.element=s.firstElementChild,r&&(this.element.id=r),this.attach(n)}attach(e){this.hostElement.insertAdjacentElement(e?"afterbegin":"beforeend",this.element)}}class l extends i{constructor(){super("project-input","app",!0,"user-input"),this.configure()}gatherUserInput(){const e=this.titleInputElement.value,t=this.descriptionInputElement.value,n=this.peopleInputElement.value;return[{value:e,required:!0,minLength:3,maxLength:16},{value:t,required:!0,minLength:10,maxLength:1024},{value:+n,required:!0,min:1,max:10}].some((e=>!function(e){let t=!0;return e.required&&(t=t&&e.value.toString().trim().length>0),e.minLength&&"string"==typeof e.value&&(t=t&&e.value.length>=e.minLength),e.maxLength&&"string"==typeof e.value&&(t=t&&e.value.length<=e.maxLength),null!=e.min&&"number"==typeof e.value&&(t=t&&e.value>=e.min),null!=e.max&&"number"==typeof e.value&&(t=t&&e.value<=e.max),t}(e)))?void alert("Title must be minmum 3 or maximum 16 length long.\nTitle must be minmum 10 or maximum 1024 length long.\nNumber of people must be minmum 1 or maximum 10 assigned."):[e,t,+n]}clearInput(){this.titleInputElement.value="",this.descriptionInputElement.value="",this.peopleInputElement.value=""}submitHandler(e){e.preventDefault();const t=this.gatherUserInput();if(Array.isArray(t)){const[e,n,r]=t;s.addProject(e,n,r),this.clearInput()}}configure(){this.titleInputElement=this.element.querySelector("#title"),this.descriptionInputElement=this.element.querySelector("#description"),this.peopleInputElement=this.element.querySelector("#people"),this.element.addEventListener("submit",this.submitHandler)}renderContent(){throw new Error("Method not implemented.")}}!function(e,t,n,r){var s,i=arguments.length,l=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)l=Reflect.decorate(e,t,n,r);else for(var o=e.length-1;o>=0;o--)(s=e[o])&&(l=(i<3?s(l):i>3?s(t,n,l):s(t,n))||l);i>3&&l&&Object.defineProperty(t,n,l)}([e],l.prototype,"submitHandler",null);var o=function(e,t,n,r){var s,i=arguments.length,l=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)l=Reflect.decorate(e,t,n,r);else for(var o=e.length-1;o>=0;o--)(s=e[o])&&(l=(i<3?s(l):i>3?s(t,n,l):s(t,n))||l);return i>3&&l&&Object.defineProperty(t,n,l),l};class a extends i{constructor(e,t,n){super("single-project",e,!1,t.id),this.project=t,this.handleDelete=n,this.configure(),this.renderContent()}get persons(){return this.project.people>1?`${this.project.people} persons`:`${this.project.people} person`}dragStartHandler(e){e.dataTransfer.setData("text/plain",this.project.id),e.dataTransfer.effectAllowed="move"}dragEndHandler(e){e.dataTransfer.clearData("text/plain")}configure(){this.element.addEventListener("dragstart",this.dragStartHandler),this.element.addEventListener("dragend",this.dragEndHandler)}renderContent(){this.element.querySelector("h2").textContent=this.project.title,this.element.querySelector("h3").textContent=this.persons+" assigned",this.element.querySelector("p").textContent=this.project.description,this.element.querySelector("button").addEventListener("click",this.handleDelete.bind(null,this.project.id))}}o([e],a.prototype,"dragStartHandler",null),o([e],a.prototype,"dragEndHandler",null);var c=function(e,t,n,r){var s,i=arguments.length,l=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)l=Reflect.decorate(e,t,n,r);else for(var o=e.length-1;o>=0;o--)(s=e[o])&&(l=(i<3?s(l):i>3?s(t,n,l):s(t,n))||l);return i>3&&l&&Object.defineProperty(t,n,l),l};class d extends i{constructor(e){super("project-list","app",!1,`${e}-projects`),this.type=e,this.configure(),this.renderContent()}dragOverHandler(e){e.dataTransfer&&"text/plain"===e.dataTransfer.types[0]&&(e.preventDefault(),this.element.querySelector("ul").classList.add("droppable"))}dragLeaveHandler(e){this.element.querySelector("ul").classList.remove("droppable")}dropHandler(e){const n=e.dataTransfer.getData("text/plain");s.moveProject(n,"active"===this.type?t.Active:t.Finished)}configure(){this.element.addEventListener("dragover",this.dragOverHandler),this.element.addEventListener("dragleave",this.dragLeaveHandler),this.element.addEventListener("drop",this.dropHandler),s.addListener((e=>{const n=e.filter((e=>"active"===this.type?e.status===t.Active:e.status===t.Finished));this.assignedProjects=n,this.renderProjects()}))}deleteProject(e){s.deleteProject(e)}renderProjects(){document.getElementById(`${this.type}-projects-list`).innerHTML="";for(const e of this.assignedProjects)new a(this.element.querySelector("ul").id,e,this.deleteProject)}renderContent(){const e=`${this.type}-projects-list`;this.element.querySelector("ul").id=e,this.element.querySelector("h2").textContent=this.type.toUpperCase()+" PROJECTS"}}c([e],d.prototype,"dragOverHandler",null),c([e],d.prototype,"dragLeaveHandler",null),c([e],d.prototype,"dropHandler",null),new l,new d("active"),new d("finished")})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly90eXBlc2NyaXB0LXByYWN0aWNlLy4vc3JjL0RlY29yYXRvcnMvYXV0by1iaW5kLnRzIiwid2VicGFjazovL3R5cGVzY3JpcHQtcHJhY3RpY2UvLi9zcmMvaW5kZXgudHMiLCJ3ZWJwYWNrOi8vdHlwZXNjcmlwdC1wcmFjdGljZS8uL3NyYy9Nb2RlbHMvcHJvamVjdC50cyIsIndlYnBhY2s6Ly90eXBlc2NyaXB0LXByYWN0aWNlLy4vc3JjL1N0b3Jlcy9Qcm9qZWN0U3RvcmUudHMiLCJ3ZWJwYWNrOi8vdHlwZXNjcmlwdC1wcmFjdGljZS8uL3NyYy9Db21wb25lbnRzL2NvbXBvbmVudC50cyIsIndlYnBhY2s6Ly90eXBlc2NyaXB0LXByYWN0aWNlLy4vc3JjL0NvbXBvbmVudHMvcHJvamVjdC1pbnB1dC50cyIsIndlYnBhY2s6Ly90eXBlc2NyaXB0LXByYWN0aWNlLy4vc3JjL1V0aWxzL3ZhbGlkYXRpb24udHMiLCJ3ZWJwYWNrOi8vdHlwZXNjcmlwdC1wcmFjdGljZS8uL3NyYy9Db21wb25lbnRzL3Byb2plY3QtaXRlbS50cyIsIndlYnBhY2s6Ly90eXBlc2NyaXB0LXByYWN0aWNlLy4vc3JjL0NvbXBvbmVudHMvcHJvamVjdC1saXN0LnRzIiwid2VicGFjazovL3R5cGVzY3JpcHQtcHJhY3RpY2UvLi9zcmMvYXBwLnRzIl0sIm5hbWVzIjpbIkF1dG9CaW5kIiwiXyIsIl8yIiwiZGVzY3JpcHRvciIsIm9yaWdpbmFsTWV0aG9kIiwidmFsdWUiLCJjb25maWd1cmFibGUiLCJnZXQiLCJiaW5kIiwidGhpcyIsIlByb2plY3RTdGF0dXMiLCJQcm9qZWN0IiwiY29uc3RydWN0b3IiLCJpZCIsInRpdGxlIiwiZGVzY3JpcHRpb24iLCJwZW9wbGUiLCJzdGF0dXMiLCJQcm9qZWN0U3RvcmUiLCJsaXN0ZW5lcnMiLCJhZGRMaXN0ZW5lciIsImxpc3RlbmVyRm4iLCJwdXNoIiwic3VwZXIiLCJwcm9qZWN0cyIsImluc3RhbmNlIiwiYWRkUHJvamVjdCIsIm5ld1Byb2plY3QiLCJNYXRoIiwicmFuZG9tIiwidG9TdHJpbmciLCJBY3RpdmUiLCJzbGljZSIsImRlbGV0ZVByb2plY3QiLCJwcm9qZWN0IiwiZmluZCIsInAiLCJzcGxpY2UiLCJpbmRleE9mIiwibW92ZVByb2plY3QiLCJuZXdTdGF0dXMiLCJ1cGRhdGVMaXN0ZW5lcnMiLCJwcm9qZWN0U3RvcmUiLCJnZXRJbnN0YW5jZSIsIkNvbXBvbmVudCIsInRlbXBsYXRlSWQiLCJob3N0RWxlbWVudElkIiwiaW5zZXJ0QXRTdGFydCIsIm5ld0VsZW1lbnRJZCIsInRlbXBsYXRlRWxlbWVudCIsImRvY3VtZW50IiwiZ2V0RWxlbWVudEJ5SWQiLCJob3N0RWxlbWVudCIsImltcG9ydGVkTm9kZSIsImltcG9ydE5vZGUiLCJjb250ZW50IiwiZWxlbWVudCIsImZpcnN0RWxlbWVudENoaWxkIiwiYXR0YWNoIiwiaW5zZXJ0QWRqYWNlbnRFbGVtZW50IiwiUHJvamVjdElucHV0IiwiY29uZmlndXJlIiwiZ2F0aGVyVXNlcklucHV0IiwiZW50ZXJlZFRpdGxlIiwidGl0bGVJbnB1dEVsZW1lbnQiLCJlbnRlcmVkRGVzY3JpcHRpb24iLCJkZXNjcmlwdGlvbklucHV0RWxlbWVudCIsImVudGVyZWRQZW9wbGUiLCJwZW9wbGVJbnB1dEVsZW1lbnQiLCJyZXF1aXJlZCIsIm1pbkxlbmd0aCIsIm1heExlbmd0aCIsIm1pbiIsIm1heCIsInNvbWUiLCJ2YWxpZGF0YWJsZSIsImlucHV0IiwiaXNWYWxpZCIsInRyaW0iLCJsZW5ndGgiLCJ2YWxpZGF0ZSIsImFsZXJ0IiwiY2xlYXJJbnB1dCIsInN1Ym1pdEhhbmRsZXIiLCJldmVudCIsInByZXZlbnREZWZhdWx0IiwidXNlcklucHV0IiwiQXJyYXkiLCJpc0FycmF5IiwicXVlcnlTZWxlY3RvciIsImFkZEV2ZW50TGlzdGVuZXIiLCJyZW5kZXJDb250ZW50IiwiRXJyb3IiLCJQcm9qZWN0SXRlbSIsImhvc3RJZCIsImhhbmRsZURlbGV0ZSIsImRyYWdTdGFydEhhbmRsZXIiLCJkYXRhVHJhbnNmZXIiLCJzZXREYXRhIiwiZWZmZWN0QWxsb3dlZCIsImRyYWdFbmRIYW5kbGVyIiwiY2xlYXJEYXRhIiwidGV4dENvbnRlbnQiLCJwZXJzb25zIiwiUHJvamVjdExpc3QiLCJ0eXBlIiwiZHJhZ092ZXJIYW5kbGVyIiwidHlwZXMiLCJjbGFzc0xpc3QiLCJhZGQiLCJkcmFnTGVhdmVIYW5kbGVyIiwiX2V2ZW50IiwicmVtb3ZlIiwiZHJvcEhhbmRsZXIiLCJwcmpJZCIsImdldERhdGEiLCJGaW5pc2hlZCIsInJlbGV2ZW50UHJvamVjdHMiLCJmaWx0ZXIiLCJwcmoiLCJhc3NpZ25lZFByb2plY3RzIiwicmVuZGVyUHJvamVjdHMiLCJpbm5lckhUTUwiLCJsaXN0SWQiLCJ0b1VwcGVyQ2FzZSJdLCJtYXBwaW5ncyI6Im1CQUFPLFNBQVNBLEVBQVNDLEVBQVFDLEVBQVlDLEdBQ3pDLE1BQU1DLEVBQWlCRCxFQUFXRSxNQVFsQyxNQVAwQyxDQUN0Q0MsY0FBYyxFQUNkQyxNQUVJLE9BRGdCSCxFQUFlSSxLQUFLQyxRQ01oRCxJQUFZQyxHQUFaLFNBQVlBLEdBQ1Isa0JBQW1CLHNCQUR2QixDQUFZQSxNQUFhLEtDVGxCLE1BQU1DLEVBRVRDLFlBQ1dDLEVBQ0FDLEVBQ0FDLEVBQ0FDLEVBQ0FDLEdBSkEsS0FBQUosS0FDQSxLQUFBQyxRQUNBLEtBQUFDLGNBQ0EsS0FBQUMsU0FDQSxLQUFBQyxVQ0VSLE1BQU1DLFVBUk4sTUFBUCxjQUNjLEtBQUFDLFVBQTJCLEdBRXJDQyxZQUFZQyxHQUNSWixLQUFLVSxVQUFVRyxLQUFLRCxLQVF4QixjQUNJRSxRQUpJLEtBQUFDLFNBQXNCLEdBTzlCLHFCQUNJLE9BQUlmLEtBQUtnQixXQUdUaEIsS0FBS2dCLFNBQVcsSUFBSVAsR0FGVFQsS0FBS2dCLFNBTXBCQyxXQUFXWixFQUFlQyxFQUFxQkMsR0FDM0MsTUFBTVcsRUFBYSxJQUFJaEIsRUFDZmlCLEtBQUtDLFNBQVNDLFdBQ2RoQixFQUFPQyxFQUFhQyxFQUNwQk4sRUFBY3FCLFFB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S2dILG9CQUlMeEYsY0FBY2lGLEdBQ2xCeEUsRUFBYVQsY0FBY2lGLEdBR3ZCTyxpQkFDZ0J2RSxTQUFTQyxlQUFlLEdBQUcxQyxLQUFLZ0csc0JBRXhDaUIsVUFBWSxHQUN4QixJQUFLLE1BQU14RixLQUFXekIsS0FBSytHLGlCQUN2QixJQUFJM0IsRUFBWXBGLEtBQUsrQyxRQUFRaUMsY0FBYyxNQUFPNUUsR0FBSXFCLEVBQVN6QixLQUFLd0IsZUFJNUUwRCxnQkFDSSxNQUFNZ0MsRUFBUyxHQUFHbEgsS0FBS2dHLHFCQUN2QmhHLEtBQUsrQyxRQUFRaUMsY0FBYyxNQUFPNUUsR0FBSzhHLEVBQ3ZDbEgsS0FBSytDLFFBQVFpQyxjQUFjLE1BQU9hLFlBQWM3RixLQUFLZ0csS0FBS21CLGNBQWdCLGFBbEQ5RSxHQURDNUgsRyxvQ0FVRCxHQURDQSxHLHFDQU9ELEdBRENBLEcsZ0NDN0JMLElBQUk0RCxFQUNKLElBQUk0QyxFQUFZLFVBQ2hCLElBQUlBLEVBQVksYSIsImZpbGUiOiJidW5kbGUuanMiLCJzb3VyY2VzQ29udGVudCI6WyJleHBvcnQgZnVuY3Rpb24gQXV0b0JpbmQoXzogYW55LCBfMjogc3RyaW5nLCBkZXNjcmlwdG9yOiBQcm9wZXJ0eURlc2NyaXB0b3IpIHtcclxuICAgIGNvbnN0IG9yaWdpbmFsTWV0aG9kID0gZGVzY3JpcHRvci52YWx1ZTtcclxuICAgIGNvbnN0IGFkakRlc2NyaXB0b3I6IFByb3BlcnR5RGVzY3JpcHRvciA9IHtcclxuICAgICAgICBjb25maWd1cmFibGU6IHRydWUsXHJcbiAgICAgICAgZ2V0KCkge1xyXG4gICAgICAgICAgICBjb25zdCBib3VuZEZuID0gb3JpZ2luYWxNZXRob2QuYmluZCh0aGlzKTtcclxuICAgICAgICAgICAgcmV0dXJuIGJvdW5kRm47XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgcmV0dXJuIGFkakRlc2NyaXB0b3I7XHJcbn0iLCJleHBvcnQgaW50ZXJmYWNlIERyYWdnYWJsZSB7XHJcbiAgICBkcmFnU3RhcnRIYW5kbGVyKGV2ZW50OiBEcmFnRXZlbnQpOiB2b2lkO1xyXG4gICAgZHJhZ0VuZEhhbmRsZXIoZXZlbnQ6IERyYWdFdmVudCk6IHZvaWQ7XHJcbn1cclxuICAgIFxyXG5leHBvcnQgaW50ZXJmYWNlIERyYWdUYXJnZXQge1xyXG4gICAgZHJhZ092ZXJIYW5kbGVyKGV2ZW50OiBEcmFnRXZlbnQpOiB2b2lkO1xyXG4gICAgZHJvcEhhbmRsZXIoZXZlbnQ6IERyYWdFdmVudCk6IHZvaWQ7XHJcbiAgICBkcmFnTGVhdmVIYW5kbGVyKGV2ZW50OiBEcmFnRXZlbnQpOiB2b2lkO1xyXG59XHJcblxyXG5leHBvcnQgZW51bSBQcm9qZWN0U3RhdHVzIHtcclxuICAgIEFjdGl2ZSA9ICdhY3RpdmUnLCBGaW5pc2hlZCA9ICdmaW5pc2hlZCdcclxufVxyXG4gICAgXHJcbmV4cG9ydCB0eXBlIExpc3RlbmVyPFQ+ID0gKGl0ZW1zOiBUW10pID0+IHZvaWQ7XHJcblxyXG5leHBvcnQgaW50ZXJmYWNlIFZhbGlkYXRhYmxlIHtcclxuICAgIHZhbHVlOiBzdHJpbmcgfCBudW1iZXI7XHJcbiAgICByZXF1aXJlZD86IGJvb2xlYW47XHJcbiAgICBtaW5MZW5ndGg/OiBudW1iZXI7XHJcbiAgICBtYXhMZW5ndGg/OiBudW1iZXI7XHJcbiAgICBtaW4/OiBudW1iZXI7XHJcbiAgICBtYXg/OiBudW1iZXI7XHJcbn0iLCJpbXBvcnQgeyBQcm9qZWN0U3RhdHVzIH0gZnJvbSBcIi4uL2luZGV4XCI7XHJcblxyXG5leHBvcnQgY2xhc3MgUHJvamVjdFxyXG57XHJcbiAgICBjb25zdHJ1Y3RvcihcclxuICAgICAgICBwdWJsaWMgaWQ6IHN0cmluZyxcclxuICAgICAgICBwdWJsaWMgdGl0bGU6IHN0cmluZyxcclxuICAgICAgICBwdWJsaWMgZGVzY3JpcHRpb246IHN0cmluZyxcclxuICAgICAgICBwdWJsaWMgcGVvcGxlOiBudW1iZXIsXHJcbiAgICAgICAgcHVibGljIHN0YXR1czogUHJvamVjdFN0YXR1cyxcclxuICAgIClcclxuICAgIHtcclxuXHJcbiAgICB9XHJcbn1cclxuIiwiaW1wb3J0IHsgTGlzdGVuZXIsIFByb2plY3RTdGF0dXMgfSBmcm9tIFwiLi4vaW5kZXhcIjtcclxuaW1wb3J0IHsgUHJvamVjdCB9IGZyb20gXCIuLi9Nb2RlbHMvcHJvamVjdFwiO1xyXG5cclxuZXhwb3J0IGFic3RyYWN0IGNsYXNzIFN0b3JlPFQ+IHtcclxuICAgIHByb3RlY3RlZCBsaXN0ZW5lcnM6IExpc3RlbmVyPFQ+W10gPSBbXTtcclxuXHJcbiAgICBhZGRMaXN0ZW5lcihsaXN0ZW5lckZuOiBMaXN0ZW5lcjxUPikge1xyXG4gICAgICAgIHRoaXMubGlzdGVuZXJzLnB1c2gobGlzdGVuZXJGbik7XHJcbiAgICB9XHJcbn1cclxuXHJcbmV4cG9ydCBjbGFzcyBQcm9qZWN0U3RvcmUgZXh0ZW5kcyBTdG9yZTxQcm9qZWN0PiB7XHJcbiAgICBwcml2YXRlIHByb2plY3RzOiBQcm9qZWN0W10gPSBbXTtcclxuICAgIHByaXZhdGUgc3RhdGljIGluc3RhbmNlOiBQcm9qZWN0U3RvcmU7XHJcblxyXG4gICAgcHJpdmF0ZSBjb25zdHJ1Y3RvcigpIHtcclxuICAgICAgICBzdXBlcigpO1xyXG4gICAgfVxyXG5cclxuICAgIHN0YXRpYyBnZXRJbnN0YW5jZSgpIHtcclxuICAgICAgICBpZiAodGhpcy5pbnN0YW5jZSkge1xyXG4gICAgICAgICAgICByZXR1cm4gdGhpcy5pbnN0YW5jZTtcclxuICAgICAgICB9XHJcbiAgICAgICAgdGhpcy5pbnN0YW5jZSA9IG5ldyBQcm9qZWN0U3RvcmUoKTtcclxuICAgICAgICByZXR1cm4gdGhpcy5pbnN0YW5jZTtcclxuICAgIH1cclxuXHJcbiAgICBhZGRQcm9qZWN0KHRpdGxlOiBzdHJpbmcsIGRlc2NyaXB0aW9uOiBzdHJpbmcsIHBlb3BsZTogbnVtYmVyKSB7XHJcbiAgICAgICAgY29uc3QgbmV3UHJvamVjdCA9IG5ldyBQcm9qZWN0KFxyXG4gICAgICAgICAgICAgICAgTWF0aC5yYW5kb20oKS50b1N0cmluZygpLFxyXG4gICAgICAgICAgICAgICAgdGl0bGUsIGRlc2NyaXB0aW9uLCBwZW9wbGUsXHJcbiAgICAgICAgICAgICAgICBQcm9qZWN0U3RhdHVzLkFjdGl2ZSxcclxuICAgICAgICApXHJcbiAgICAgICAgdGhpcy5wcm9qZWN0cy5wdXNoKG5ld1Byb2plY3QpO1xyXG4gICAgICAgIFxyXG4gICAgICAgIGZvciAoY29uc3QgbGlzdGVuZXJGbiBvZiB0aGlzLmxpc3RlbmVycykge1xyXG4gICAgICAgICAgICBsaXN0ZW5lckZuKHRoaXMucHJvamVjdHMuc2xpY2UoKSk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIGRlbGV0ZVByb2plY3QoaWQ6IHN0cmluZykge1xyXG4gICAgICAgIGNvbnN0IHByb2plY3QgPSB0aGlzLnByb2plY3RzLmZpbmQocCA9PiBwLmlkID09PSBpZCk7XHJcbiAgICAgICAgaWYgKCFwcm9qZWN0KSByZXR1cm47XHJcbiAgICAgICAgdGhpcy5wcm9qZWN0cy5zcGxpY2UodGhpcy5wcm9qZWN0cy5pbmRleE9mKHByb2plY3QpLCAxKTtcclxuXHJcbiAgICAgICAgZm9yIChjb25zdCBsaXN0ZW5lckZuIG9mIHRoaXMubGlzdGVuZXJzKSB7XHJcbiAgICAgICAgICAgIGxpc3RlbmVyRm4odGhpcy5wcm9qZWN0cy5zbGljZSgpKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgbW92ZVByb2plY3QoaWQ6IHN0cmluZywgbmV3U3RhdHVzOiBQcm9qZWN0U3RhdHVzKSB7XHJcbiAgICBjb25zdCBwcm9qZWN0ID0gdGhpcy5wcm9qZWN0cy5maW5kKHAgPT4gcC5pZCA9PT0gaWQpO1xyXG4gICAgaWYgKHByb2plY3QgJiYgKHByb2plY3Quc3RhdHVzICE9PSBuZXdTdGF0dXMpKSB7XHJcbiAgICAgICAgcHJvamVjdC5zdGF0dXMgPSBuZXdTdGF0dXM7XHJcbiAgICAgICAgdGhpcy51cGRhdGVMaXN0ZW5lcnMoKTtcclxuICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBwcml2YXRlIHVwZGF0ZUxpc3RlbmVycygpIHtcclxuICAgICAgICBmb3IgKGNvbnN0IGxpc3RlbmVyRm4gb2YgdGhpcy5saXN0ZW5lcnMpIHtcclxuICAgICAgICAgICAgbGlzdGVuZXJGbih0aGlzLnByb2plY3RzLnNsaWNlKCkpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxufVxyXG5cclxuZXhwb3J0IGNvbnN0IHByb2plY3RTdG9yZSA9IFByb2plY3RTdG9yZS5nZXRJbnN0YW5jZSgpOyIsImV4cG9ydCBhYnN0cmFjdCBjbGFzcyBDb21wb25lbnQ8VCBleHRlbmRzIEhUTUxFbGVtZW50LCBVIGV4dGVuZHMgSFRNTEVsZW1lbnQ+IHtcclxuICAgIHRlbXBsYXRlRWxlbWVudDogSFRNTFRlbXBsYXRlRWxlbWVudDtcclxuICAgIGhvc3RFbGVtZW50OiBUO1xyXG4gICAgZWxlbWVudDogVTtcclxuXHJcbiAgICBjb25zdHJ1Y3RvcihcclxuICAgICAgICB0ZW1wbGF0ZUlkOiBzdHJpbmcsXHJcbiAgICAgICAgaG9zdEVsZW1lbnRJZDogc3RyaW5nLFxyXG4gICAgICAgIGluc2VydEF0U3RhcnQ6IGJvb2xlYW4sXHJcbiAgICAgICAgbmV3RWxlbWVudElkPzogc3RyaW5nLFxyXG4gICAgICAgICkge1xyXG4gICAgICAgIHRoaXMudGVtcGxhdGVFbGVtZW50ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQodGVtcGxhdGVJZCkhIGFzIEhUTUxUZW1wbGF0ZUVsZW1lbnQ7XHJcbiAgICAgICAgdGhpcy5ob3N0RWxlbWVudCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKGhvc3RFbGVtZW50SWQpISBhcyBUO1xyXG5cclxuICAgICAgICBjb25zdCBpbXBvcnRlZE5vZGUgPSBkb2N1bWVudC5pbXBvcnROb2RlKHRoaXMudGVtcGxhdGVFbGVtZW50LmNvbnRlbnQsIHRydWUpO1xyXG4gICAgICAgIHRoaXMuZWxlbWVudCA9IGltcG9ydGVkTm9kZS5maXJzdEVsZW1lbnRDaGlsZCBhcyBVO1xyXG4gICAgICAgIGlmIChuZXdFbGVtZW50SWQpXHJcbiAgICAgICAgdGhpcy5lbGVtZW50LmlkID0gbmV3RWxlbWVudElkO1xyXG5cclxuICAgICAgICB0aGlzLmF0dGFjaChpbnNlcnRBdFN0YXJ0KTtcclxuICAgIH1cclxuXHJcbiAgICBwcml2YXRlIGF0dGFjaChpbnNlcnRBdFN0YXJ0OiBib29sZWFuKSB7XHJcbiAgICAgICAgdGhpcy5ob3N0RWxlbWVudC5pbnNlcnRBZGphY2VudEVsZW1lbnQoIGluc2VydEF0U3RhcnQgPyAgJ2FmdGVyYmVnaW4nIDogJ2JlZm9yZWVuZCcsIHRoaXMuZWxlbWVudCk7XHJcbiAgICB9XHJcblxyXG4gICAgYWJzdHJhY3QgY29uZmlndXJlKCk6IHZvaWQ7XHJcbiAgICBhYnN0cmFjdCByZW5kZXJDb250ZW50KCk6IHZvaWQ7XHJcbn1cclxuIiwiaW1wb3J0IHsgQXV0b0JpbmQgfSBmcm9tIFwiLi4vRGVjb3JhdG9ycy9hdXRvLWJpbmRcIjtcclxuaW1wb3J0IHsgVmFsaWRhdGFibGUgfSBmcm9tIFwiLi4vaW5kZXhcIjtcclxuaW1wb3J0IHsgcHJvamVjdFN0b3JlIH0gZnJvbSBcIi4uL1N0b3Jlcy9Qcm9qZWN0U3RvcmVcIjtcclxuaW1wb3J0IHsgdmFsaWRhdGUgfSBmcm9tIFwiLi4vVXRpbHMvdmFsaWRhdGlvblwiO1xyXG5pbXBvcnQgeyBDb21wb25lbnQgfSBmcm9tIFwiLi9jb21wb25lbnRcIjtcclxuXHJcbmV4cG9ydCBjbGFzcyBQcm9qZWN0SW5wdXQgZXh0ZW5kcyBDb21wb25lbnQgPEhUTUxEaXZFbGVtZW50LCBIVE1MRWxlbWVudD4ge1xyXG4gICAgdGl0bGVJbnB1dEVsZW1lbnQhOiBIVE1MSW5wdXRFbGVtZW50O1xyXG4gICAgZGVzY3JpcHRpb25JbnB1dEVsZW1lbnQhOiBIVE1MSW5wdXRFbGVtZW50O1xyXG4gICAgcGVvcGxlSW5wdXRFbGVtZW50ITogSFRNTElucHV0RWxlbWVudDtcclxuXHJcbiAgICBjb25zdHJ1Y3RvcigpIHtcclxuICAgICAgICBzdXBlcigncHJvamVjdC1pbnB1dCcsICdhcHAnLCB0cnVlLCAndXNlci1pbnB1dCcpO1xyXG5cclxuICAgICAgICB0aGlzLmNvbmZpZ3VyZSgpO1xyXG4gICAgfVxyXG5cclxuICAgIHByaXZhdGUgZ2F0aGVyVXNlcklucHV0KCk6IFtzdHJpbmcsIHN0cmluZywgbnVtYmVyXSB8IHZvaWQge1xyXG4gICAgICAgIGNvbnN0IGVudGVyZWRUaXRsZSA9IHRoaXMudGl0bGVJbnB1dEVsZW1lbnQudmFsdWU7XHJcbiAgICAgICAgY29uc3QgZW50ZXJlZERlc2NyaXB0aW9uID0gdGhpcy5kZXNjcmlwdGlvbklucHV0RWxlbWVudC52YWx1ZTtcclxuICAgICAgICBjb25zdCBlbnRlcmVkUGVvcGxlID0gdGhpcy5wZW9wbGVJbnB1dEVsZW1lbnQudmFsdWU7XHJcblxyXG4gICAgICAgIGNvbnN0IHRpdGxlVmFsaWRhdGFibGU6IFZhbGlkYXRhYmxlID0ge1xyXG4gICAgICAgICAgICB2YWx1ZTogZW50ZXJlZFRpdGxlLFxyXG4gICAgICAgICAgICByZXF1aXJlZDogdHJ1ZSxcclxuICAgICAgICAgICAgbWluTGVuZ3RoOiAzLFxyXG4gICAgICAgICAgICBtYXhMZW5ndGg6IDE2LFxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgY29uc3QgZGVzY3JpcHRpb25WYWxpZGF0YWJsZTogVmFsaWRhdGFibGUgPSB7XHJcbiAgICAgICAgICAgIHZhbHVlOiBlbnRlcmVkRGVzY3JpcHRpb24sXHJcbiAgICAgICAgICAgIHJlcXVpcmVkOiB0cnVlLFxyXG4gICAgICAgICAgICBtaW5MZW5ndGg6IDEwLFxyXG4gICAgICAgICAgICBtYXhMZW5ndGg6IDEwMjQsXHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBjb25zdCBwZW9wbGVWYWxpZGF0YWJsZTogVmFsaWRhdGFibGUgPSB7XHJcbiAgICAgICAgICAgIHZhbHVlOiArZW50ZXJlZFBlb3BsZSxcclxuICAgICAgICAgICAgcmVxdWlyZWQ6IHRydWUsXHJcbiAgICAgICAgICAgIG1pbjogMSxcclxuICAgICAgICAgICAgbWF4OiAxMCxcclxuICAgICAgICB9XHJcbiAgICAgICAgXHJcbiAgICAgICAgaWYgKFt0aXRsZVZhbGlkYXRhYmxlLCBkZXNjcmlwdGlvblZhbGlkYXRhYmxlLCBwZW9wbGVWYWxpZGF0YWJsZV0uc29tZSh2YWxpZGF0YWJsZSA9PiAhdmFsaWRhdGUodmFsaWRhdGFibGUpKSkge1xyXG4gICAgICAgICAgICBhbGVydCgnVGl0bGUgbXVzdCBiZSBtaW5tdW0gMyBvciBtYXhpbXVtIDE2IGxlbmd0aCBsb25nLlxcblRpdGxlIG11c3QgYmUgbWlubXVtIDEwIG9yIG1heGltdW0gMTAyNCBsZW5ndGggbG9uZy5cXG5OdW1iZXIgb2YgcGVvcGxlIG11c3QgYmUgbWlubXVtIDEgb3IgbWF4aW11bSAxMCBhc3NpZ25lZC4nKTtcclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIHJldHVybiBbZW50ZXJlZFRpdGxlLCBlbnRlcmVkRGVzY3JpcHRpb24sICtlbnRlcmVkUGVvcGxlXTtcclxuICAgICAgICB9XHJcblxyXG4gICAgfVxyXG5cclxuICAgIHByaXZhdGUgY2xlYXJJbnB1dCgpIHtcclxuICAgICAgICB0aGlzLnRpdGxlSW5wdXRFbGVtZW50LnZhbHVlID0gJyc7XHJcbiAgICAgICAgdGhpcy5kZXNjcmlwdGlvbklucHV0RWxlbWVudC52YWx1ZSA9ICcnO1xyXG4gICAgICAgIHRoaXMucGVvcGxlSW5wdXRFbGVtZW50LnZhbHVlID0gJyc7XHJcbiAgICB9XHJcblxyXG4gICAgQEF1dG9CaW5kXHJcbiAgICBwcml2YXRlIHN1Ym1pdEhhbmRsZXIoZXZlbnQ6IEV2ZW50KTogdm9pZCB7XHJcbiAgICAgICAgZXZlbnQucHJldmVudERlZmF1bHQoKTtcclxuICAgICAgICBjb25zdCB1c2VySW5wdXQgPSB0aGlzLmdhdGhlclVzZXJJbnB1dCgpITtcclxuICAgICAgICBpZiAoQXJyYXkuaXNBcnJheSh1c2VySW5wdXQpKSB7XHJcbiAgICAgICAgICAgIGNvbnN0IFt0aXRsZSwgZGVzY3JpcHRpb24sIHBlb3BsZV0gPSB1c2VySW5wdXQ7XHJcbiAgICAgICAgICAgIHByb2plY3RTdG9yZS5hZGRQcm9qZWN0KHRpdGxlLCBkZXNjcmlwdGlvbiwgcGVvcGxlKTtcclxuICAgICAgICAgICAgdGhpcy5jbGVhcklucHV0KCk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIGNvbmZpZ3VyZSgpOiB2b2lkXHJcbiAgICB7XHJcbiAgICAgICAgdGhpcy50aXRsZUlucHV0RWxlbWVudCA9IHRoaXMuZWxlbWVudC5xdWVyeVNlbGVjdG9yKCcjdGl0bGUnKSBhcyBIVE1MSW5wdXRFbGVtZW50O1xyXG4gICAgICAgIHRoaXMuZGVzY3JpcHRpb25JbnB1dEVsZW1lbnQgPSB0aGlzLmVsZW1lbnQucXVlcnlTZWxlY3RvcignI2Rlc2NyaXB0aW9uJykgYXMgSFRNTElucHV0RWxlbWVudDtcclxuICAgICAgICB0aGlzLnBlb3BsZUlucHV0RWxlbWVudCA9IHRoaXMuZWxlbWVudC5xdWVyeVNlbGVjdG9yKCcjcGVvcGxlJykgYXMgSFRNTElucHV0RWxlbWVudDtcclxuXHJcbiAgICAgICAgdGhpcy5lbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ3N1Ym1pdCcsIHRoaXMuc3VibWl0SGFuZGxlcik7XHJcbiAgICB9XHJcblxyXG4gICAgcmVuZGVyQ29udGVudCgpOiB2b2lkXHJcbiAgICB7XHJcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiTWV0aG9kIG5vdCBpbXBsZW1lbnRlZC5cIik7XHJcbiAgICB9XHJcbn0iLCJpbXBvcnQgeyBWYWxpZGF0YWJsZSB9IGZyb20gXCIuLi9pbmRleFwiO1xyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIHZhbGlkYXRlKGlucHV0OiBWYWxpZGF0YWJsZSkge1xyXG4gICAgbGV0IGlzVmFsaWQgPSB0cnVlO1xyXG4gICAgaWYgKGlucHV0LnJlcXVpcmVkKSB7XHJcbiAgICAgICAgaXNWYWxpZCA9IGlzVmFsaWQgJiYgaW5wdXQudmFsdWUudG9TdHJpbmcoKS50cmltKCkubGVuZ3RoID4gMDtcclxuICAgIH1cclxuXHJcbiAgICBpZiAoaW5wdXQubWluTGVuZ3RoICYmICh0eXBlb2YgaW5wdXQudmFsdWUgPT09ICdzdHJpbmcnKSkge1xyXG4gICAgICAgIGlzVmFsaWQgPSBpc1ZhbGlkICYmIGlucHV0LnZhbHVlLmxlbmd0aCA+PSBpbnB1dC5taW5MZW5ndGg7XHJcbiAgICB9XHJcbiAgICBcclxuICAgIGlmIChpbnB1dC5tYXhMZW5ndGggJiYgKHR5cGVvZiBpbnB1dC52YWx1ZSA9PT0gJ3N0cmluZycpKSB7XHJcbiAgICAgICAgaXNWYWxpZCA9IGlzVmFsaWQgJiYgaW5wdXQudmFsdWUubGVuZ3RoIDw9IGlucHV0Lm1heExlbmd0aDtcclxuICAgIH1cclxuXHJcbiAgICBpZiAoKGlucHV0Lm1pbiAhPSBudWxsKSAmJiAodHlwZW9mIGlucHV0LnZhbHVlID09PSAnbnVtYmVyJykpIHtcclxuICAgICAgICBpc1ZhbGlkID0gaXNWYWxpZCAmJiBpbnB1dC52YWx1ZSA+PSBpbnB1dC5taW47XHJcbiAgICB9XHJcbiAgICBcclxuICAgIGlmICgoaW5wdXQubWF4ICE9IG51bGwpICYmICh0eXBlb2YgaW5wdXQudmFsdWUgPT09ICdudW1iZXInKSkge1xyXG4gICAgICAgIGlzVmFsaWQgPSBpc1ZhbGlkICYmIGlucHV0LnZhbHVlIDw9IGlucHV0Lm1heDtcclxuICAgIH1cclxuICAgIHJldHVybiBpc1ZhbGlkO1xyXG59IiwiaW1wb3J0IHsgQXV0b0JpbmQgfSBmcm9tIFwiLi4vRGVjb3JhdG9ycy9hdXRvLWJpbmRcIjtcclxuaW1wb3J0IHsgRHJhZ2dhYmxlIH0gZnJvbSBcIi4uL2luZGV4XCI7XHJcbmltcG9ydCB7IFByb2plY3QgfSBmcm9tIFwiLi4vTW9kZWxzL3Byb2plY3RcIjtcclxuaW1wb3J0IHsgQ29tcG9uZW50IH0gZnJvbSBcIi4vY29tcG9uZW50XCI7XHJcblxyXG5leHBvcnQgY2xhc3MgUHJvamVjdEl0ZW0gZXh0ZW5kcyBDb21wb25lbnQgPEhUTUxVTGlzdEVsZW1lbnQsIEhUTUxMSUVsZW1lbnQ+IGltcGxlbWVudHMgRHJhZ2dhYmxlIHtcclxuICAgIHByaXZhdGUgcHJvamVjdDogUHJvamVjdDtcclxuICAgIHByaXZhdGUgaGFuZGxlRGVsZXRlOiAocHJqSWQ6IHN0cmluZykgPT4gdm9pZDtcclxuXHJcbiAgICBnZXQgcGVyc29ucygpIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5wcm9qZWN0LnBlb3BsZSA+IDEgPyBgJHt0aGlzLnByb2plY3QucGVvcGxlfSBwZXJzb25zYCA6IGAke3RoaXMucHJvamVjdC5wZW9wbGV9IHBlcnNvbmBcclxuICAgIH1cclxuXHJcbiAgICBjb25zdHJ1Y3Rvcihob3N0SWQ6IHN0cmluZywgcHJvamVjdDogUHJvamVjdCwgaGFuZGxlRGVsZXRlOiAocHJqSWQ6IHN0cmluZykgPT4gdm9pZCkge1xyXG4gICAgICAgIHN1cGVyKCdzaW5nbGUtcHJvamVjdCcsIGhvc3RJZCwgZmFsc2UsIHByb2plY3QuaWQpO1xyXG4gICAgICAgIHRoaXMucHJvamVjdCA9IHByb2plY3Q7XHJcbiAgICAgICAgdGhpcy5oYW5kbGVEZWxldGUgPSBoYW5kbGVEZWxldGU7XHJcblxyXG4gICAgICAgIHRoaXMuY29uZmlndXJlKCk7XHJcbiAgICAgICAgdGhpcy5yZW5kZXJDb250ZW50KCk7XHJcbiAgICB9XHJcblxyXG4gICAgQEF1dG9CaW5kXHJcbiAgICBkcmFnU3RhcnRIYW5kbGVyKGV2ZW50OiBEcmFnRXZlbnQpIHtcclxuICAgICAgICBldmVudC5kYXRhVHJhbnNmZXIhLnNldERhdGEoJ3RleHQvcGxhaW4nLCB0aGlzLnByb2plY3QuaWQpO1xyXG4gICAgICAgIGV2ZW50LmRhdGFUcmFuc2ZlciEuZWZmZWN0QWxsb3dlZCA9ICdtb3ZlJzsgICAgICAgIFxyXG4gICAgfVxyXG5cclxuICAgIEBBdXRvQmluZFxyXG4gICAgZHJhZ0VuZEhhbmRsZXIoZXZlbnQ6IERyYWdFdmVudCkge1xyXG4gICAgICAgIGV2ZW50LmRhdGFUcmFuc2ZlciEuY2xlYXJEYXRhKCd0ZXh0L3BsYWluJyk7XHJcbiAgICB9XHJcblxyXG4gICAgY29uZmlndXJlKCkge1xyXG4gICAgICAgIHRoaXMuZWxlbWVudC5hZGRFdmVudExpc3RlbmVyKCdkcmFnc3RhcnQnLCB0aGlzLmRyYWdTdGFydEhhbmRsZXIpO1xyXG4gICAgICAgIHRoaXMuZWxlbWVudC5hZGRFdmVudExpc3RlbmVyKCdkcmFnZW5kJywgdGhpcy5kcmFnRW5kSGFuZGxlcik7XHJcbiAgICB9XHJcblxyXG4gICAgcmVuZGVyQ29udGVudCgpIHtcclxuICAgICAgICB0aGlzLmVsZW1lbnQucXVlcnlTZWxlY3RvcignaDInKSEudGV4dENvbnRlbnQgPSB0aGlzLnByb2plY3QudGl0bGU7XHJcbiAgICAgICAgdGhpcy5lbGVtZW50LnF1ZXJ5U2VsZWN0b3IoJ2gzJykhLnRleHRDb250ZW50ID0gdGhpcy5wZXJzb25zICsgJyBhc3NpZ25lZCc7XHJcbiAgICAgICAgdGhpcy5lbGVtZW50LnF1ZXJ5U2VsZWN0b3IoJ3AnKSEudGV4dENvbnRlbnQgPSB0aGlzLnByb2plY3QuZGVzY3JpcHRpb247XHJcbiAgICAgICAgY29uc3QgYnRuID0gdGhpcy5lbGVtZW50LnF1ZXJ5U2VsZWN0b3IoJ2J1dHRvbicpISBhcyBIVE1MQnV0dG9uRWxlbWVudDtcclxuICAgICAgICBidG4uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIHRoaXMuaGFuZGxlRGVsZXRlLmJpbmQobnVsbCwgdGhpcy5wcm9qZWN0LmlkKSk7XHJcbiAgICB9XHJcbn0iLCJpbXBvcnQgeyBBdXRvQmluZCB9IGZyb20gXCIuLi9EZWNvcmF0b3JzL2F1dG8tYmluZFwiO1xyXG5pbXBvcnQgeyBEcmFnVGFyZ2V0LCBQcm9qZWN0U3RhdHVzIH0gZnJvbSBcIi4uL2luZGV4XCI7XHJcbmltcG9ydCB7IFByb2plY3QgfSBmcm9tIFwiLi4vTW9kZWxzL3Byb2plY3RcIjtcclxuaW1wb3J0IHsgcHJvamVjdFN0b3JlIH0gZnJvbSBcIi4uL1N0b3Jlcy9Qcm9qZWN0U3RvcmVcIjtcclxuaW1wb3J0IHsgQ29tcG9uZW50IH0gZnJvbSBcIi4vY29tcG9uZW50XCI7XHJcbmltcG9ydCB7IFByb2plY3RJdGVtIH0gZnJvbSBcIi4vcHJvamVjdC1pdGVtXCI7XHJcblxyXG5leHBvcnQgY2xhc3MgUHJvamVjdExpc3QgZXh0ZW5kcyBDb21wb25lbnQ8SFRNTERpdkVsZW1lbnQsIEhUTUxFbGVtZW50PiBpbXBsZW1lbnRzIERyYWdUYXJnZXQge1xyXG4gICAgYXNzaWduZWRQcm9qZWN0cyE6IFByb2plY3RbXTtcclxuXHJcbiAgICBjb25zdHJ1Y3Rvcihwcml2YXRlIHR5cGU6ICdhY3RpdmUnIHwgJ2ZpbmlzaGVkJykge1xyXG4gICAgICAgIHN1cGVyKCdwcm9qZWN0LWxpc3QnLCBgYXBwYCwgZmFsc2UsIGAke3R5cGV9LXByb2plY3RzYCApO1xyXG5cclxuICAgICAgICB0aGlzLmNvbmZpZ3VyZSgpXHJcbiAgICAgICAgdGhpcy5yZW5kZXJDb250ZW50KCk7XHJcbiAgICB9XHJcblxyXG4gICAgQEF1dG9CaW5kXHJcbiAgICBkcmFnT3ZlckhhbmRsZXIoZXZlbnQ6IERyYWdFdmVudCkge1xyXG4gICAgICAgIGlmIChldmVudC5kYXRhVHJhbnNmZXIgJiYgZXZlbnQuZGF0YVRyYW5zZmVyLnR5cGVzWzBdID09PSAndGV4dC9wbGFpbicpIHtcclxuICAgICAgICAgICAgZXZlbnQucHJldmVudERlZmF1bHQoKTsgICBcclxuICAgICAgICAgICAgY29uc3QgbGlzdEVsID0gdGhpcy5lbGVtZW50LnF1ZXJ5U2VsZWN0b3IoJ3VsJykhO1xyXG4gICAgICAgICAgICBsaXN0RWwuY2xhc3NMaXN0LmFkZCgnZHJvcHBhYmxlJyk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIEBBdXRvQmluZFxyXG4gICAgZHJhZ0xlYXZlSGFuZGxlcihfZXZlbnQ6IERyYWdFdmVudCkge1xyXG4gICAgICAgIGNvbnN0IGxpc3RFbCA9IHRoaXMuZWxlbWVudC5xdWVyeVNlbGVjdG9yKCd1bCcpITtcclxuICAgICAgICBsaXN0RWwuY2xhc3NMaXN0LnJlbW92ZSgnZHJvcHBhYmxlJyk7XHJcbiAgICB9XHJcblxyXG4gICAgQEF1dG9CaW5kXHJcbiAgICBkcm9wSGFuZGxlcihldmVudDogRHJhZ0V2ZW50KSB7XHJcbiAgICAgICAgY29uc3QgcHJqSWQgPSBldmVudC5kYXRhVHJhbnNmZXIhLmdldERhdGEoJ3RleHQvcGxhaW4nKTtcclxuICAgICAgICBwcm9qZWN0U3RvcmUubW92ZVByb2plY3QocHJqSWQsIHRoaXMudHlwZSA9PT0gJ2FjdGl2ZScgPyBQcm9qZWN0U3RhdHVzLkFjdGl2ZSA6IFByb2plY3RTdGF0dXMuRmluaXNoZWQpO1xyXG4gICAgfVxyXG5cclxuICAgIGNvbmZpZ3VyZSgpIHtcclxuICAgICAgICB0aGlzLmVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignZHJhZ292ZXInLCB0aGlzLmRyYWdPdmVySGFuZGxlcik7XHJcbiAgICAgICAgdGhpcy5lbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ2RyYWdsZWF2ZScsIHRoaXMuZHJhZ0xlYXZlSGFuZGxlcik7XHJcbiAgICAgICAgdGhpcy5lbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ2Ryb3AnLCB0aGlzLmRyb3BIYW5kbGVyKTtcclxuICAgICAgICBcclxuICAgICAgICBwcm9qZWN0U3RvcmUuYWRkTGlzdGVuZXIoKHByb2plY3RzOiBQcm9qZWN0W10pID0+IHtcclxuICAgICAgICAgICAgY29uc3QgcmVsZXZlbnRQcm9qZWN0cyA9IHByb2plY3RzLmZpbHRlcihwcmogPT4ge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMudHlwZSA9PT0gJ2FjdGl2ZScgPyBwcmouc3RhdHVzID09PSBQcm9qZWN0U3RhdHVzLkFjdGl2ZSA6IHByai5zdGF0dXMgPT09IFByb2plY3RTdGF0dXMuRmluaXNoZWQ7XHJcbiAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgIHRoaXMuYXNzaWduZWRQcm9qZWN0cyA9IHJlbGV2ZW50UHJvamVjdHM7XHJcbiAgICAgICAgICAgIHRoaXMucmVuZGVyUHJvamVjdHMoKTtcclxuICAgICAgICB9KVxyXG4gICAgfVxyXG5cclxuICAgIHByaXZhdGUgZGVsZXRlUHJvamVjdChwcmpJZDogc3RyaW5nKSB7XHJcbiAgICAgICAgcHJvamVjdFN0b3JlLmRlbGV0ZVByb2plY3QocHJqSWQpO1xyXG4gICAgfVxyXG5cclxuICAgIHByaXZhdGUgcmVuZGVyUHJvamVjdHMoKSB7XHJcbiAgICAgICAgY29uc3QgbGlzdEVsZW1lbnQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChgJHt0aGlzLnR5cGV9LXByb2plY3RzLWxpc3RgKSEgYXMgSFRNTFVMaXN0RWxlbWVudDtcclxuXHJcbiAgICAgICAgbGlzdEVsZW1lbnQuaW5uZXJIVE1MID0gJyc7XHJcbiAgICAgICAgZm9yIChjb25zdCBwcm9qZWN0IG9mIHRoaXMuYXNzaWduZWRQcm9qZWN0cykge1xyXG4gICAgICAgICAgICBuZXcgUHJvamVjdEl0ZW0odGhpcy5lbGVtZW50LnF1ZXJ5U2VsZWN0b3IoJ3VsJykhLmlkLCBwcm9qZWN0LCB0aGlzLmRlbGV0ZVByb2plY3QpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIFxyXG4gICAgcmVuZGVyQ29udGVudCgpIHtcclxuICAgICAgICBjb25zdCBsaXN0SWQgPSBgJHt0aGlzLnR5cGV9LXByb2plY3RzLWxpc3RgO1xyXG4gICAgICAgIHRoaXMuZWxlbWVudC5xdWVyeVNlbGVjdG9yKCd1bCcpIS5pZCA9IGxpc3RJZDtcclxuICAgICAgICB0aGlzLmVsZW1lbnQucXVlcnlTZWxlY3RvcignaDInKSEudGV4dENvbnRlbnQgPSB0aGlzLnR5cGUudG9VcHBlckNhc2UoKSArICcgUFJPSkVDVFMnO1xyXG4gICAgfVxyXG59IiwiaW1wb3J0IHsgUHJvamVjdElucHV0IH0gZnJvbSBcIi4vQ29tcG9uZW50cy9wcm9qZWN0LWlucHV0XCI7XHJcbmltcG9ydCB7IFByb2plY3RMaXN0IH0gZnJvbSBcIi4vQ29tcG9uZW50cy9wcm9qZWN0LWxpc3RcIjtcclxuXHJcbm5ldyBQcm9qZWN0SW5wdXQoKTtcclxubmV3IFByb2plY3RMaXN0KCdhY3RpdmUnKTtcclxubmV3IFByb2plY3RMaXN0KCdmaW5pc2hlZCcpOyJdLCJzb3VyY2VSb290IjoiIn0=