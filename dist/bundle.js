(()=>{"use strict";function e(e,t,n){const r=n.value;return{configurable:!0,get(){return r.bind(this)}}}var t;!function(e){e.Active="Active",e.Finished="Finished"}(t||(t={}));class n{constructor(e,t,n,r,s){this.id=e,this.title=t,this.description=n,this.people=r,this.status=s}}class r extends class{constructor(){this.listeners=[]}addListener(e){this.listeners.push(e)}}{constructor(){super(),this.projects=[]}static getInstance(){return this.instance||(this.instance=new r),this.instance}addProject(e,r,s){const i=new n(Math.random().toString(),e,r,s,t.Active);this.projects.push(i);for(const e of this.listeners)e(this.projects.slice())}moveProject(e,t){const n=this.projects.find((t=>t.id===e));n&&n.status!==t&&(n.status=t,this.updateListeners())}updateListeners(){for(const e of this.listeners)e(this.projects.slice())}}const s=r.getInstance();class i{constructor(e,t,n,r){this.templateElement=document.getElementById(e),this.hostElement=document.getElementById(t);const s=document.importNode(this.templateElement.content,!0);this.element=s.firstElementChild,r&&(this.element.id=r),this.attach(n)}attach(e){this.hostElement.insertAdjacentElement(e?"afterbegin":"beforeend",this.element)}}class o extends i{constructor(){super("project-input","app",!0,"user-input"),this.configure()}gatherUserInput(){const e=this.titleInputElement.value,t=this.descriptionInputElement.value,n=this.peopleInputElement.value;return[{value:e,required:!0,minLength:3,maxLength:16},{value:t,required:!0,minLength:10,maxLength:260},{value:+n,required:!0,min:1,max:10}].some((e=>!function(e){let t=!0;return e.required&&(t=t&&e.value.toString().trim().length>0),e.minLength&&"string"==typeof e.value&&(t=t&&e.value.length>=e.minLength),e.maxLength&&"string"==typeof e.value&&(t=t&&e.value.length<=e.maxLength),null!=e.min&&"number"==typeof e.value&&(t=t&&e.value>=e.min),null!=e.max&&"number"==typeof e.value&&(t=t&&e.value<=e.max),t}(e)))?void alert("Invalid input."):[e,t,+n]}clearInput(){this.titleInputElement.value="",this.descriptionInputElement.value="",this.peopleInputElement.value=""}submitHandler(e){e.preventDefault();const t=this.gatherUserInput();if(Array.isArray(t)){const[e,n,r]=t;s.addProject(e,n,r),this.clearInput()}}configure(){this.titleInputElement=this.element.querySelector("#title"),this.descriptionInputElement=this.element.querySelector("#description"),this.peopleInputElement=this.element.querySelector("#people"),this.element.addEventListener("submit",this.submitHandler)}renderContent(){throw new Error("Method not implemented.")}}!function(e,t,n,r){var s,i=arguments.length,o=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,n,r);else for(var l=e.length-1;l>=0;l--)(s=e[l])&&(o=(i<3?s(o):i>3?s(t,n,o):s(t,n))||o);i>3&&o&&Object.defineProperty(t,n,o)}([e],o.prototype,"submitHandler",null);var l=function(e,t,n,r){var s,i=arguments.length,o=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,n,r);else for(var l=e.length-1;l>=0;l--)(s=e[l])&&(o=(i<3?s(o):i>3?s(t,n,o):s(t,n))||o);return i>3&&o&&Object.defineProperty(t,n,o),o};class a extends i{constructor(e,t){super("single-project",e,!1,t.id),this.project=t,this.configure(),this.renderContent()}get persons(){return this.project.people>1?`${this.project.people} persons`:`${this.project.people} person`}dragStartHandler(e){e.dataTransfer.setData("text/plain",this.project.id),e.dataTransfer.effectAllowed="move"}dragEndHandler(e){console.log("event end")}configure(){this.element.addEventListener("dragstart",this.dragStartHandler),this.element.addEventListener("dragend",this.dragEndHandler)}renderContent(){this.element.querySelector("h2").textContent=this.project.title,this.element.querySelector("h3").textContent=this.persons+" assigned",this.element.querySelector("p").textContent=this.project.description}}l([e],a.prototype,"dragStartHandler",null),l([e],a.prototype,"dragEndHandler",null);var c=function(e,t,n,r){var s,i=arguments.length,o=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,n,r);else for(var l=e.length-1;l>=0;l--)(s=e[l])&&(o=(i<3?s(o):i>3?s(t,n,o):s(t,n))||o);return i>3&&o&&Object.defineProperty(t,n,o),o};class d extends i{constructor(e){super("project-list","app",!1,`${e}-projects`),this.type=e,this.configure(),this.renderContent()}dragOverHandler(e){e.dataTransfer&&"text/plain"===e.dataTransfer.types[0]&&(e.preventDefault(),this.element.querySelector("ul").classList.add("droppable"))}dragLeaveHandler(e){this.element.querySelector("ul").classList.remove("droppable")}dropHandler(e){const n=e.dataTransfer.getData("text/plain");s.moveProject(n,"active"===this.type?t.Active:t.Finished)}configure(){this.element.addEventListener("dragover",this.dragOverHandler),this.element.addEventListener("dragleave",this.dragLeaveHandler),this.element.addEventListener("drop",this.dropHandler),s.addListener((e=>{const n=e.filter((e=>"active"===this.type?e.status===t.Active:e.status===t.Finished));this.assignedProjects=n,this.renderProjects()}))}renderProjects(){document.getElementById(`${this.type}-projects-list`).innerHTML="";for(const e of this.assignedProjects)new a(this.element.querySelector("ul").id,e)}renderContent(){const e=`${this.type}-projects-list`;this.element.querySelector("ul").id=e,this.element.querySelector("h2").textContent=this.type.toUpperCase()+" PROJECTS"}}c([e],d.prototype,"dragOverHandler",null),c([e],d.prototype,"dragLeaveHandler",null),c([e],d.prototype,"dropHandler",null),new o,new d("active"),new d("finished")})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly90eXBlc2NyaXB0LXByYWN0aWNlLy4vc3JjL0RlY29yYXRvcnMvYXV0by1iaW5kLnRzIiwid2VicGFjazovL3R5cGVzY3JpcHQtcHJhY3RpY2UvLi9zcmMvaW5kZXgudHMiLCJ3ZWJwYWNrOi8vdHlwZXNjcmlwdC1wcmFjdGljZS8uL3NyYy9Nb2RlbHMvcHJvamVjdC50cyIsIndlYnBhY2s6Ly90eXBlc2NyaXB0LXByYWN0aWNlLy4vc3JjL1N0b3Jlcy9Qcm9qZWN0U3RvcmUudHMiLCJ3ZWJwYWNrOi8vdHlwZXNjcmlwdC1wcmFjdGljZS8uL3NyYy9Db21wb25lbnRzL2NvbXBvbmVudC50cyIsIndlYnBhY2s6Ly90eXBlc2NyaXB0LXByYWN0aWNlLy4vc3JjL0NvbXBvbmVudHMvcHJvamVjdC1pbnB1dC50cyIsIndlYnBhY2s6Ly90eXBlc2NyaXB0LXByYWN0aWNlLy4vc3JjL1V0aWxzL3ZhbGlkYXRpb24udHMiLCJ3ZWJwYWNrOi8vdHlwZXNjcmlwdC1wcmFjdGljZS8uL3NyYy9Db21wb25lbnRzL3Byb2plY3QtaXRlbS50cyIsIndlYnBhY2s6Ly90eXBlc2NyaXB0LXByYWN0aWNlLy4vc3JjL0NvbXBvbmVudHMvcHJvamVjdC1saXN0LnRzIiwid2VicGFjazovL3R5cGVzY3JpcHQtcHJhY3RpY2UvLi9zcmMvYXBwLnRzIl0sIm5hbWVzIjpbIkF1dG9CaW5kIiwiXyIsIl8yIiwiZGVzY3JpcHRvciIsIm9yaWdpbmFsTWV0aG9kIiwidmFsdWUiLCJjb25maWd1cmFibGUiLCJnZXQiLCJiaW5kIiwidGhpcyIsIlByb2plY3RTdGF0dXMiLCJQcm9qZWN0IiwiY29uc3RydWN0b3IiLCJpZCIsInRpdGxlIiwiZGVzY3JpcHRpb24iLCJwZW9wbGUiLCJzdGF0dXMiLCJQcm9qZWN0U3RvcmUiLCJsaXN0ZW5lcnMiLCJhZGRMaXN0ZW5lciIsImxpc3RlbmVyRm4iLCJwdXNoIiwic3VwZXIiLCJwcm9qZWN0cyIsImluc3RhbmNlIiwiYWRkUHJvamVjdCIsIm5ld1Byb2plY3QiLCJNYXRoIiwicmFuZG9tIiwidG9TdHJpbmciLCJBY3RpdmUiLCJzbGljZSIsIm1vdmVQcm9qZWN0IiwibmV3U3RhdHVzIiwicHJvamVjdCIsImZpbmQiLCJwIiwidXBkYXRlTGlzdGVuZXJzIiwicHJvamVjdFN0b3JlIiwiZ2V0SW5zdGFuY2UiLCJDb21wb25lbnQiLCJ0ZW1wbGF0ZUlkIiwiaG9zdEVsZW1lbnRJZCIsImluc2VydEF0U3RhcnQiLCJuZXdFbGVtZW50SWQiLCJ0ZW1wbGF0ZUVsZW1lbnQiLCJkb2N1bWVudCIsImdldEVsZW1lbnRCeUlkIiwiaG9zdEVsZW1lbnQiLCJpbXBvcnRlZE5vZGUiLCJpbXBvcnROb2RlIiwiY29udGVudCIsImVsZW1lbnQiLCJmaXJzdEVsZW1lbnRDaGlsZCIsImF0dGFjaCIsImluc2VydEFkamFjZW50RWxlbWVudCIsIlByb2plY3RJbnB1dCIsImNvbmZpZ3VyZSIsImdhdGhlclVzZXJJbnB1dCIsImVudGVyZWRUaXRsZSIsInRpdGxlSW5wdXRFbGVtZW50IiwiZW50ZXJlZERlc2NyaXB0aW9uIiwiZGVzY3JpcHRpb25JbnB1dEVsZW1lbnQiLCJlbnRlcmVkUGVvcGxlIiwicGVvcGxlSW5wdXRFbGVtZW50IiwicmVxdWlyZWQiLCJtaW5MZW5ndGgiLCJtYXhMZW5ndGgiLCJtaW4iLCJtYXgiLCJzb21lIiwidmFsaWRhdGFibGUiLCJpbnB1dCIsImlzVmFsaWQiLCJ0cmltIiwibGVuZ3RoIiwidmFsaWRhdGUiLCJhbGVydCIsImNsZWFySW5wdXQiLCJzdWJtaXRIYW5kbGVyIiwiZXZlbnQiLCJwcmV2ZW50RGVmYXVsdCIsInVzZXJJbnB1dCIsIkFycmF5IiwiaXNBcnJheSIsInF1ZXJ5U2VsZWN0b3IiLCJhZGRFdmVudExpc3RlbmVyIiwicmVuZGVyQ29udGVudCIsIkVycm9yIiwiUHJvamVjdEl0ZW0iLCJob3N0SWQiLCJkcmFnU3RhcnRIYW5kbGVyIiwiZGF0YVRyYW5zZmVyIiwic2V0RGF0YSIsImVmZmVjdEFsbG93ZWQiLCJkcmFnRW5kSGFuZGxlciIsIl9ldmVudCIsImNvbnNvbGUiLCJsb2ciLCJ0ZXh0Q29udGVudCIsInBlcnNvbnMiLCJQcm9qZWN0TGlzdCIsInR5cGUiLCJkcmFnT3ZlckhhbmRsZXIiLCJ0eXBlcyIsImNsYXNzTGlzdCIsImFkZCIsImRyYWdMZWF2ZUhhbmRsZXIiLCJyZW1vdmUiLCJkcm9wSGFuZGxlciIsInByaklkIiwiZ2V0RGF0YSIsIkZpbmlzaGVkIiwicmVsZXZlbnRQcm9qZWN0cyIsImZpbHRlciIsInByaiIsImFzc2lnbmVkUHJvamVjdHMiLCJyZW5kZXJQcm9qZWN0cyIsImlubmVySFRNTCIsImxpc3RJZCIsInRvVXBwZXJDYXNlIl0sIm1hcHBpbmdzIjoibUJBQU8sU0FBU0EsRUFBU0MsRUFBUUMsRUFBWUMsR0FDekMsTUFBTUMsRUFBaUJELEVBQVdFLE1BUWxDLE1BUDBDLENBQ3RDQyxjQUFjLEVBQ2RDLE1BRUksT0FEZ0JILEVBQWVJLEtBQUtDLFFDTWhELElBQVlDLEdBQVosU0FBWUEsR0FDUixrQkFBbUIsc0JBRHZCLENBQVlBLE1BQWEsS0NUbEIsTUFBTUMsRUFFVEMsWUFDV0MsRUFDQUMsRUFDQUMsRUFDQUMsRUFDQUMsR0FKQSxLQUFBSixLQUNBLEtBQUFDLFFBQ0EsS0FBQUMsY0FDQSxLQUFBQyxTQUNBLEtBQUFDLFVDRVIsTUFBTUMsVUFSTixNQUFQLGNBQ2MsS0FBQUMsVUFBMkIsR0FFckNDLFlBQVlDLEdBQ1JaLEtBQUtVLFVBQVVHLEtBQUtELEtBUXhCLGNBQ0lFLFFBSkksS0FBQUMsU0FBc0IsR0FPOUIscUJBQ0ksT0FBSWYsS0FBS2dCLFdBR1RoQixLQUFLZ0IsU0FBVyxJQUFJUCxHQUZUVCxLQUFLZ0IsU0FNcEJDLFdBQVdaLEVBQWVDLEVBQXFCQyxHQUMzQyxNQUFNVyxFQUFhLElBQUloQixFQUNmaUIsS0FBS0MsU0FBU0MsV0FDZGhCLEVBQU9DLEVBQWFDLEVBQ3BCTixFQUFjcUIsUUFFdEJ0QixLQUFLZSxTQUFTRixLQUFLSyxHQUVuQixJQUFLLE1BQU1OLEtBQWNa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WSxVQUNoQixJQUFJQSxFQUFZLGEiLCJmaWxlIjoiYnVuZGxlLmpzIiwic291cmNlc0NvbnRlbnQiOlsiZXhwb3J0IGZ1bmN0aW9uIEF1dG9CaW5kKF86IGFueSwgXzI6IHN0cmluZywgZGVzY3JpcHRvcjogUHJvcGVydHlEZXNjcmlwdG9yKSB7XHJcbiAgICBjb25zdCBvcmlnaW5hbE1ldGhvZCA9IGRlc2NyaXB0b3IudmFsdWU7XHJcbiAgICBjb25zdCBhZGpEZXNjcmlwdG9yOiBQcm9wZXJ0eURlc2NyaXB0b3IgPSB7XHJcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlLFxyXG4gICAgICAgIGdldCgpIHtcclxuICAgICAgICAgICAgY29uc3QgYm91bmRGbiA9IG9yaWdpbmFsTWV0aG9kLmJpbmQodGhpcyk7XHJcbiAgICAgICAgICAgIHJldHVybiBib3VuZEZuO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIHJldHVybiBhZGpEZXNjcmlwdG9yO1xyXG59IiwiZXhwb3J0IGludGVyZmFjZSBEcmFnZ2FibGUge1xyXG4gICAgZHJhZ1N0YXJ0SGFuZGxlcihldmVudDogRHJhZ0V2ZW50KTogdm9pZDtcclxuICAgIGRyYWdFbmRIYW5kbGVyKGV2ZW50OiBEcmFnRXZlbnQpOiB2b2lkO1xyXG59XHJcbiAgICBcclxuZXhwb3J0IGludGVyZmFjZSBEcmFnVGFyZ2V0IHtcclxuICAgIGRyYWdPdmVySGFuZGxlcihldmVudDogRHJhZ0V2ZW50KTogdm9pZDtcclxuICAgIGRyb3BIYW5kbGVyKGV2ZW50OiBEcmFnRXZlbnQpOiB2b2lkO1xyXG4gICAgZHJhZ0xlYXZlSGFuZGxlcihldmVudDogRHJhZ0V2ZW50KTogdm9pZDtcclxufVxyXG5cclxuZXhwb3J0IGVudW0gUHJvamVjdFN0YXR1cyB7XHJcbiAgICBBY3RpdmUgPSAnQWN0aXZlJywgRmluaXNoZWQgPSAnRmluaXNoZWQnXHJcbn1cclxuICAgIFxyXG5leHBvcnQgdHlwZSBMaXN0ZW5lcjxUPiA9IChpdGVtczogVFtdKSA9PiB2b2lkO1xyXG5cclxuZXhwb3J0IGludGVyZmFjZSBWYWxpZGF0YWJsZSB7XHJcbiAgICB2YWx1ZTogc3RyaW5nIHwgbnVtYmVyO1xyXG4gICAgcmVxdWlyZWQ/OiBib29sZWFuO1xyXG4gICAgbWluTGVuZ3RoPzogbnVtYmVyO1xyXG4gICAgbWF4TGVuZ3RoPzogbnVtYmVyO1xyXG4gICAgbWluPzogbnVtYmVyO1xyXG4gICAgbWF4PzogbnVtYmVyO1xyXG59IiwiaW1wb3J0IHsgUHJvamVjdFN0YXR1cyB9IGZyb20gXCIuLi9pbmRleFwiO1xyXG5cclxuZXhwb3J0IGNsYXNzIFByb2plY3Rcclxue1xyXG4gICAgY29uc3RydWN0b3IoXHJcbiAgICAgICAgcHVibGljIGlkOiBzdHJpbmcsXHJcbiAgICAgICAgcHVibGljIHRpdGxlOiBzdHJpbmcsXHJcbiAgICAgICAgcHVibGljIGRlc2NyaXB0aW9uOiBzdHJpbmcsXHJcbiAgICAgICAgcHVibGljIHBlb3BsZTogbnVtYmVyLFxyXG4gICAgICAgIHB1YmxpYyBzdGF0dXM6IFByb2plY3RTdGF0dXMsXHJcbiAgICApXHJcbiAgICB7XHJcblxyXG4gICAgfVxyXG59XHJcbiIsImltcG9ydCB7IExpc3RlbmVyLCBQcm9qZWN0U3RhdHVzIH0gZnJvbSBcIi4uL2luZGV4XCI7XHJcbmltcG9ydCB7IFByb2plY3QgfSBmcm9tIFwiLi4vTW9kZWxzL3Byb2plY3RcIjtcclxuXHJcbmV4cG9ydCBhYnN0cmFjdCBjbGFzcyBTdG9yZTxUPiB7XHJcbiAgICBwcm90ZWN0ZWQgbGlzdGVuZXJzOiBMaXN0ZW5lcjxUPltdID0gW107XHJcblxyXG4gICAgYWRkTGlzdGVuZXIobGlzdGVuZXJGbjogTGlzdGVuZXI8VD4pIHtcclxuICAgICAgICB0aGlzLmxpc3RlbmVycy5wdXNoKGxpc3RlbmVyRm4pO1xyXG4gICAgfVxyXG59XHJcblxyXG5leHBvcnQgY2xhc3MgUHJvamVjdFN0b3JlIGV4dGVuZHMgU3RvcmU8UHJvamVjdD4ge1xyXG4gICAgcHJpdmF0ZSBwcm9qZWN0czogUHJvamVjdFtdID0gW107XHJcbiAgICBwcml2YXRlIHN0YXRpYyBpbnN0YW5jZTogUHJvamVjdFN0b3JlO1xyXG5cclxuICAgIHByaXZhdGUgY29uc3RydWN0b3IoKSB7XHJcbiAgICAgICAgc3VwZXIoKTtcclxuICAgIH1cclxuXHJcbiAgICBzdGF0aWMgZ2V0SW5zdGFuY2UoKSB7XHJcbiAgICAgICAgaWYgKHRoaXMuaW5zdGFuY2UpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHRoaXMuaW5zdGFuY2U7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHRoaXMuaW5zdGFuY2UgPSBuZXcgUHJvamVjdFN0b3JlKCk7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuaW5zdGFuY2U7XHJcbiAgICB9XHJcblxyXG4gICAgYWRkUHJvamVjdCh0aXRsZTogc3RyaW5nLCBkZXNjcmlwdGlvbjogc3RyaW5nLCBwZW9wbGU6IG51bWJlcikge1xyXG4gICAgICAgIGNvbnN0IG5ld1Byb2plY3QgPSBuZXcgUHJvamVjdChcclxuICAgICAgICAgICAgICAgIE1hdGgucmFuZG9tKCkudG9TdHJpbmcoKSxcclxuICAgICAgICAgICAgICAgIHRpdGxlLCBkZXNjcmlwdGlvbiwgcGVvcGxlLFxyXG4gICAgICAgICAgICAgICAgUHJvamVjdFN0YXR1cy5BY3RpdmUsXHJcbiAgICAgICAgKVxyXG4gICAgICAgIHRoaXMucHJvamVjdHMucHVzaChuZXdQcm9qZWN0KTtcclxuICAgICAgICBcclxuICAgICAgICBmb3IgKGNvbnN0IGxpc3RlbmVyRm4gb2YgdGhpcy5saXN0ZW5lcnMpIHtcclxuICAgICAgICAgICAgbGlzdGVuZXJGbih0aGlzLnByb2plY3RzLnNsaWNlKCkpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBtb3ZlUHJvamVjdChpZDogc3RyaW5nLCBuZXdTdGF0dXM6IFByb2plY3RTdGF0dXMpIHtcclxuICAgIGNvbnN0IHByb2plY3QgPSB0aGlzLnByb2plY3RzLmZpbmQocCA9PiBwLmlkID09PSBpZCk7XHJcbiAgICBpZiAocHJvamVjdCAmJiAocHJvamVjdC5zdGF0dXMgIT09IG5ld1N0YXR1cykpIHtcclxuICAgICAgICBwcm9qZWN0LnN0YXR1cyA9IG5ld1N0YXR1cztcclxuICAgICAgICB0aGlzLnVwZGF0ZUxpc3RlbmVycygpO1xyXG4gICAgfVxyXG4gICAgfVxyXG5cclxuICAgIHByaXZhdGUgdXBkYXRlTGlzdGVuZXJzKCkge1xyXG4gICAgICAgIGZvciAoY29uc3QgbGlzdGVuZXJGbiBvZiB0aGlzLmxpc3RlbmVycykge1xyXG4gICAgICAgICAgICBsaXN0ZW5lckZuKHRoaXMucHJvamVjdHMuc2xpY2UoKSk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG59XHJcblxyXG5leHBvcnQgY29uc3QgcHJvamVjdFN0b3JlID0gUHJvamVjdFN0b3JlLmdldEluc3RhbmNlKCk7IiwiZXhwb3J0IGFic3RyYWN0IGNsYXNzIENvbXBvbmVudDxUIGV4dGVuZHMgSFRNTEVsZW1lbnQsIFUgZXh0ZW5kcyBIVE1MRWxlbWVudD4ge1xyXG4gICAgdGVtcGxhdGVFbGVtZW50OiBIVE1MVGVtcGxhdGVFbGVtZW50O1xyXG4gICAgaG9zdEVsZW1lbnQ6IFQ7XHJcbiAgICBlbGVtZW50OiBVO1xyXG5cclxuICAgIGNvbnN0cnVjdG9yKFxyXG4gICAgICAgIHRlbXBsYXRlSWQ6IHN0cmluZyxcclxuICAgICAgICBob3N0RWxlbWVudElkOiBzdHJpbmcsXHJcbiAgICAgICAgaW5zZXJ0QXRTdGFydDogYm9vbGVhbixcclxuICAgICAgICBuZXdFbGVtZW50SWQ/OiBzdHJpbmcsXHJcbiAgICAgICAgKSB7XHJcbiAgICAgICAgdGhpcy50ZW1wbGF0ZUVsZW1lbnQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCh0ZW1wbGF0ZUlkKSEgYXMgSFRNTFRlbXBsYXRlRWxlbWVudDtcclxuICAgICAgICB0aGlzLmhvc3RFbGVtZW50ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoaG9zdEVsZW1lbnRJZCkhIGFzIFQ7XHJcblxyXG4gICAgICAgIGNvbnN0IGltcG9ydGVkTm9kZSA9IGRvY3VtZW50LmltcG9ydE5vZGUodGhpcy50ZW1wbGF0ZUVsZW1lbnQuY29udGVudCwgdHJ1ZSk7XHJcbiAgICAgICAgdGhpcy5lbGVtZW50ID0gaW1wb3J0ZWROb2RlLmZpcnN0RWxlbWVudENoaWxkIGFzIFU7XHJcbiAgICAgICAgaWYgKG5ld0VsZW1lbnRJZClcclxuICAgICAgICB0aGlzLmVsZW1lbnQuaWQgPSBuZXdFbGVtZW50SWQ7XHJcblxyXG4gICAgICAgIHRoaXMuYXR0YWNoKGluc2VydEF0U3RhcnQpO1xyXG4gICAgfVxyXG5cclxuICAgIHByaXZhdGUgYXR0YWNoKGluc2VydEF0U3RhcnQ6IGJvb2xlYW4pIHtcclxuICAgICAgICB0aGlzLmhvc3RFbGVtZW50Lmluc2VydEFkamFjZW50RWxlbWVudCggaW5zZXJ0QXRTdGFydCA/ICAnYWZ0ZXJiZWdpbicgOiAnYmVmb3JlZW5kJywgdGhpcy5lbGVtZW50KTtcclxuICAgIH1cclxuXHJcbiAgICBhYnN0cmFjdCBjb25maWd1cmUoKTogdm9pZDtcclxuICAgIGFic3RyYWN0IHJlbmRlckNvbnRlbnQoKTogdm9pZDtcclxufVxyXG4iLCJpbXBvcnQgeyBBdXRvQmluZCB9IGZyb20gXCIuLi9EZWNvcmF0b3JzL2F1dG8tYmluZFwiO1xyXG5pbXBvcnQgeyBWYWxpZGF0YWJsZSB9IGZyb20gXCIuLi9pbmRleFwiO1xyXG5pbXBvcnQgeyBwcm9qZWN0U3RvcmUgfSBmcm9tIFwiLi4vU3RvcmVzL1Byb2plY3RTdG9yZVwiO1xyXG5pbXBvcnQgeyB2YWxpZGF0ZSB9IGZyb20gXCIuLi9VdGlscy92YWxpZGF0aW9uXCI7XHJcbmltcG9ydCB7IENvbXBvbmVudCB9IGZyb20gXCIuL2NvbXBvbmVudFwiO1xyXG5cclxuZXhwb3J0IGNsYXNzIFByb2plY3RJbnB1dCBleHRlbmRzIENvbXBvbmVudCA8SFRNTERpdkVsZW1lbnQsIEhUTUxFbGVtZW50PiB7XHJcbiAgICB0aXRsZUlucHV0RWxlbWVudCE6IEhUTUxJbnB1dEVsZW1lbnQ7XHJcbiAgICBkZXNjcmlwdGlvbklucHV0RWxlbWVudCE6IEhUTUxJbnB1dEVsZW1lbnQ7XHJcbiAgICBwZW9wbGVJbnB1dEVsZW1lbnQhOiBIVE1MSW5wdXRFbGVtZW50O1xyXG5cclxuICAgIGNvbnN0cnVjdG9yKCkge1xyXG4gICAgICAgIHN1cGVyKCdwcm9qZWN0LWlucHV0JywgJ2FwcCcsIHRydWUsICd1c2VyLWlucHV0Jyk7XHJcblxyXG4gICAgICAgIHRoaXMuY29uZmlndXJlKCk7XHJcbiAgICB9XHJcblxyXG4gICAgcHJpdmF0ZSBnYXRoZXJVc2VySW5wdXQoKTogW3N0cmluZywgc3RyaW5nLCBudW1iZXJdIHwgdm9pZCB7XHJcbiAgICAgICAgY29uc3QgZW50ZXJlZFRpdGxlID0gdGhpcy50aXRsZUlucHV0RWxlbWVudC52YWx1ZTtcclxuICAgICAgICBjb25zdCBlbnRlcmVkRGVzY3JpcHRpb24gPSB0aGlzLmRlc2NyaXB0aW9uSW5wdXRFbGVtZW50LnZhbHVlO1xyXG4gICAgICAgIGNvbnN0IGVudGVyZWRQZW9wbGUgPSB0aGlzLnBlb3BsZUlucHV0RWxlbWVudC52YWx1ZTtcclxuXHJcbiAgICAgICAgY29uc3QgdGl0bGVWYWxpZGF0YWJsZTogVmFsaWRhdGFibGUgPSB7XHJcbiAgICAgICAgICAgIHZhbHVlOiBlbnRlcmVkVGl0bGUsXHJcbiAgICAgICAgICAgIHJlcXVpcmVkOiB0cnVlLFxyXG4gICAgICAgICAgICBtaW5MZW5ndGg6IDMsXHJcbiAgICAgICAgICAgIG1heExlbmd0aDogMTYsXHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBjb25zdCBkZXNjcmlwdGlvblZhbGlkYXRhYmxlOiBWYWxpZGF0YWJsZSA9IHtcclxuICAgICAgICAgICAgdmFsdWU6IGVudGVyZWREZXNjcmlwdGlvbixcclxuICAgICAgICAgICAgcmVxdWlyZWQ6IHRydWUsXHJcbiAgICAgICAgICAgIG1pbkxlbmd0aDogMTAsXHJcbiAgICAgICAgICAgIG1heExlbmd0aDogMjYwLFxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgY29uc3QgcGVvcGxlVmFsaWRhdGFibGU6IFZhbGlkYXRhYmxlID0ge1xyXG4gICAgICAgICAgICB2YWx1ZTogK2VudGVyZWRQZW9wbGUsXHJcbiAgICAgICAgICAgIHJlcXVpcmVkOiB0cnVlLFxyXG4gICAgICAgICAgICBtaW46IDEsXHJcbiAgICAgICAgICAgIG1heDogMTAsXHJcbiAgICAgICAgfVxyXG4gICAgICAgIFxyXG4gICAgICAgIGlmIChbdGl0bGVWYWxpZGF0YWJsZSwgZGVzY3JpcHRpb25WYWxpZGF0YWJsZSwgcGVvcGxlVmFsaWRhdGFibGVdLnNvbWUodmFsaWRhdGFibGUgPT4gIXZhbGlkYXRlKHZhbGlkYXRhYmxlKSkpIHtcclxuICAgICAgICAgICAgYWxlcnQoJ0ludmFsaWQgaW5wdXQuJyk7XHJcbiAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICByZXR1cm4gW2VudGVyZWRUaXRsZSwgZW50ZXJlZERlc2NyaXB0aW9uLCArZW50ZXJlZFBlb3BsZV07XHJcbiAgICAgICAgfVxyXG5cclxuICAgIH1cclxuXHJcbiAgICBwcml2YXRlIGNsZWFySW5wdXQoKSB7XHJcbiAgICAgICAgdGhpcy50aXRsZUlucHV0RWxlbWVudC52YWx1ZSA9ICcnO1xyXG4gICAgICAgIHRoaXMuZGVzY3JpcHRpb25JbnB1dEVsZW1lbnQudmFsdWUgPSAnJztcclxuICAgICAgICB0aGlzLnBlb3BsZUlucHV0RWxlbWVudC52YWx1ZSA9ICcnO1xyXG4gICAgfVxyXG5cclxuICAgIEBBdXRvQmluZFxyXG4gICAgcHJpdmF0ZSBzdWJtaXRIYW5kbGVyKGV2ZW50OiBFdmVudCkge1xyXG4gICAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XHJcbiAgICAgICAgY29uc3QgdXNlcklucHV0ID0gdGhpcy5nYXRoZXJVc2VySW5wdXQoKSE7XHJcbiAgICAgICAgaWYgKEFycmF5LmlzQXJyYXkodXNlcklucHV0KSkge1xyXG4gICAgICAgICAgICBjb25zdCBbdGl0bGUsIGRlc2NyaXB0aW9uLCBwZW9wbGVdID0gdXNlcklucHV0O1xyXG4gICAgICAgICAgICBwcm9qZWN0U3RvcmUuYWRkUHJvamVjdCh0aXRsZSwgZGVzY3JpcHRpb24sIHBlb3BsZSk7XHJcbiAgICAgICAgICAgIHRoaXMuY2xlYXJJbnB1dCgpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBjb25maWd1cmUoKSB7XHJcbiAgICAgICAgdGhpcy50aXRsZUlucHV0RWxlbWVudCA9IHRoaXMuZWxlbWVudC5xdWVyeVNlbGVjdG9yKCcjdGl0bGUnKSBhcyBIVE1MSW5wdXRFbGVtZW50O1xyXG4gICAgICAgIHRoaXMuZGVzY3JpcHRpb25JbnB1dEVsZW1lbnQgPSB0aGlzLmVsZW1lbnQucXVlcnlTZWxlY3RvcignI2Rlc2NyaXB0aW9uJykgYXMgSFRNTElucHV0RWxlbWVudDtcclxuICAgICAgICB0aGlzLnBlb3BsZUlucHV0RWxlbWVudCA9IHRoaXMuZWxlbWVudC5xdWVyeVNlbGVjdG9yKCcjcGVvcGxlJykgYXMgSFRNTElucHV0RWxlbWVudDtcclxuXHJcbiAgICAgICAgdGhpcy5lbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ3N1Ym1pdCcsIHRoaXMuc3VibWl0SGFuZGxlcik7XHJcbiAgICB9XHJcblxyXG4gICAgcmVuZGVyQ29udGVudCgpOiB2b2lkXHJcbiAgICB7XHJcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiTWV0aG9kIG5vdCBpbXBsZW1lbnRlZC5cIik7XHJcbiAgICB9XHJcbn0iLCJpbXBvcnQgeyBWYWxpZGF0YWJsZSB9IGZyb20gXCIuLi9pbmRleFwiO1xyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIHZhbGlkYXRlKGlucHV0OiBWYWxpZGF0YWJsZSkge1xyXG4gICAgbGV0IGlzVmFsaWQgPSB0cnVlO1xyXG4gICAgaWYgKGlucHV0LnJlcXVpcmVkKSB7XHJcbiAgICAgICAgaXNWYWxpZCA9IGlzVmFsaWQgJiYgaW5wdXQudmFsdWUudG9TdHJpbmcoKS50cmltKCkubGVuZ3RoID4gMDtcclxuICAgIH1cclxuXHJcbiAgICBpZiAoaW5wdXQubWluTGVuZ3RoICYmICh0eXBlb2YgaW5wdXQudmFsdWUgPT09ICdzdHJpbmcnKSkge1xyXG4gICAgICAgIGlzVmFsaWQgPSBpc1ZhbGlkICYmIGlucHV0LnZhbHVlLmxlbmd0aCA+PSBpbnB1dC5taW5MZW5ndGg7XHJcbiAgICB9XHJcbiAgICBcclxuICAgIGlmIChpbnB1dC5tYXhMZW5ndGggJiYgKHR5cGVvZiBpbnB1dC52YWx1ZSA9PT0gJ3N0cmluZycpKSB7XHJcbiAgICAgICAgaXNWYWxpZCA9IGlzVmFsaWQgJiYgaW5wdXQudmFsdWUubGVuZ3RoIDw9IGlucHV0Lm1heExlbmd0aDtcclxuICAgIH1cclxuXHJcbiAgICBpZiAoKGlucHV0Lm1pbiAhPSBudWxsKSAmJiAodHlwZW9mIGlucHV0LnZhbHVlID09PSAnbnVtYmVyJykpIHtcclxuICAgICAgICBpc1ZhbGlkID0gaXNWYWxpZCAmJiBpbnB1dC52YWx1ZSA+PSBpbnB1dC5taW47XHJcbiAgICB9XHJcbiAgICBcclxuICAgIGlmICgoaW5wdXQubWF4ICE9IG51bGwpICYmICh0eXBlb2YgaW5wdXQudmFsdWUgPT09ICdudW1iZXInKSkge1xyXG4gICAgICAgIGlzVmFsaWQgPSBpc1ZhbGlkICYmIGlucHV0LnZhbHVlIDw9IGlucHV0Lm1heDtcclxuICAgIH1cclxuICAgIHJldHVybiBpc1ZhbGlkO1xyXG59IiwiaW1wb3J0IHsgQXV0b0JpbmQgfSBmcm9tIFwiLi4vRGVjb3JhdG9ycy9hdXRvLWJpbmRcIjtcclxuaW1wb3J0IHsgRHJhZ2dhYmxlIH0gZnJvbSBcIi4uL2luZGV4XCI7XHJcbmltcG9ydCB7IFByb2plY3QgfSBmcm9tIFwiLi4vTW9kZWxzL3Byb2plY3RcIjtcclxuaW1wb3J0IHsgQ29tcG9uZW50IH0gZnJvbSBcIi4vY29tcG9uZW50XCI7XHJcblxyXG5leHBvcnQgY2xhc3MgUHJvamVjdEl0ZW0gZXh0ZW5kcyBDb21wb25lbnQgPEhUTUxVTGlzdEVsZW1lbnQsIEhUTUxMSUVsZW1lbnQ+IGltcGxlbWVudHMgRHJhZ2dhYmxlIHtcclxuICAgIHByaXZhdGUgcHJvamVjdDogUHJvamVjdDtcclxuXHJcbiAgICBnZXQgcGVyc29ucygpIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5wcm9qZWN0LnBlb3BsZSA+IDEgPyBgJHt0aGlzLnByb2plY3QucGVvcGxlfSBwZXJzb25zYCA6IGAke3RoaXMucHJvamVjdC5wZW9wbGV9IHBlcnNvbmBcclxuICAgIH1cclxuXHJcbiAgICBjb25zdHJ1Y3Rvcihob3N0SWQ6IHN0cmluZywgcHJvamVjdDogUHJvamVjdCkge1xyXG4gICAgICAgIHN1cGVyKCdzaW5nbGUtcHJvamVjdCcsIGhvc3RJZCwgZmFsc2UsIHByb2plY3QuaWQpO1xyXG4gICAgICAgIHRoaXMucHJvamVjdCA9IHByb2plY3Q7XHJcblxyXG4gICAgICAgIHRoaXMuY29uZmlndXJlKCk7XHJcbiAgICAgICAgdGhpcy5yZW5kZXJDb250ZW50KCk7XHJcbiAgICB9XHJcblxyXG4gICAgQEF1dG9CaW5kXHJcbiAgICBkcmFnU3RhcnRIYW5kbGVyKGV2ZW50OiBEcmFnRXZlbnQpIHtcclxuICAgICAgICBldmVudC5kYXRhVHJhbnNmZXIhLnNldERhdGEoJ3RleHQvcGxhaW4nLCB0aGlzLnByb2plY3QuaWQpO1xyXG4gICAgICAgIGV2ZW50LmRhdGFUcmFuc2ZlciEuZWZmZWN0QWxsb3dlZCA9ICdtb3ZlJzsgICAgICAgIFxyXG4gICAgfVxyXG5cclxuICAgIEBBdXRvQmluZFxyXG4gICAgZHJhZ0VuZEhhbmRsZXIoX2V2ZW50OiBEcmFnRXZlbnQpIHtcclxuICAgICAgICBjb25zb2xlLmxvZygnZXZlbnQgZW5kJyk7XHJcbiAgICB9XHJcblxyXG4gICAgY29uZmlndXJlKCkge1xyXG4gICAgICAgIHRoaXMuZWxlbWVudC5hZGRFdmVudExpc3RlbmVyKCdkcmFnc3RhcnQnLCB0aGlzLmRyYWdTdGFydEhhbmRsZXIpO1xyXG4gICAgICAgIHRoaXMuZWxlbWVudC5hZGRFdmVudExpc3RlbmVyKCdkcmFnZW5kJywgdGhpcy5kcmFnRW5kSGFuZGxlcik7XHJcbiAgICB9XHJcblxyXG4gICAgcmVuZGVyQ29udGVudCgpIHtcclxuICAgICAgICB0aGlzLmVsZW1lbnQucXVlcnlTZWxlY3RvcignaDInKSEudGV4dENvbnRlbnQgPSB0aGlzLnByb2plY3QudGl0bGU7XHJcbiAgICAgICAgdGhpcy5lbGVtZW50LnF1ZXJ5U2VsZWN0b3IoJ2gzJykhLnRleHRDb250ZW50ID0gdGhpcy5wZXJzb25zICsgJyBhc3NpZ25lZCc7XHJcbiAgICAgICAgdGhpcy5lbGVtZW50LnF1ZXJ5U2VsZWN0b3IoJ3AnKSEudGV4dENvbnRlbnQgPSB0aGlzLnByb2plY3QuZGVzY3JpcHRpb247XHJcbiAgICB9XHJcbn0gICAgIiwiaW1wb3J0IHsgQXV0b0JpbmQgfSBmcm9tIFwiLi4vRGVjb3JhdG9ycy9hdXRvLWJpbmRcIjtcclxuaW1wb3J0IHsgRHJhZ1RhcmdldCwgUHJvamVjdFN0YXR1cyB9IGZyb20gXCIuLi9pbmRleFwiO1xyXG5pbXBvcnQgeyBQcm9qZWN0IH0gZnJvbSBcIi4uL01vZGVscy9wcm9qZWN0XCI7XHJcbmltcG9ydCB7IHByb2plY3RTdG9yZSB9IGZyb20gXCIuLi9TdG9yZXMvUHJvamVjdFN0b3JlXCI7XHJcbmltcG9ydCB7IENvbXBvbmVudCB9IGZyb20gXCIuL2NvbXBvbmVudFwiO1xyXG5pbXBvcnQgeyBQcm9qZWN0SXRlbSB9IGZyb20gXCIuL3Byb2plY3QtaXRlbVwiO1xyXG5cclxuZXhwb3J0IGNsYXNzIFByb2plY3RMaXN0IGV4dGVuZHMgQ29tcG9uZW50PEhUTUxEaXZFbGVtZW50LCBIVE1MRWxlbWVudD4gaW1wbGVtZW50cyBEcmFnVGFyZ2V0IHtcclxuICAgIGFzc2lnbmVkUHJvamVjdHMhOiBQcm9qZWN0W107XHJcblxyXG4gICAgY29uc3RydWN0b3IocHJpdmF0ZSB0eXBlOiAnYWN0aXZlJyB8ICdmaW5pc2hlZCcpIHtcclxuICAgICAgICBzdXBlcigncHJvamVjdC1saXN0JywgYGFwcGAsIGZhbHNlLCBgJHt0eXBlfS1wcm9qZWN0c2AgKTtcclxuXHJcbiAgICAgICAgdGhpcy5jb25maWd1cmUoKVxyXG4gICAgICAgIHRoaXMucmVuZGVyQ29udGVudCgpO1xyXG4gICAgfVxyXG5cclxuICAgIEBBdXRvQmluZFxyXG4gICAgZHJhZ092ZXJIYW5kbGVyKGV2ZW50OiBEcmFnRXZlbnQpIHtcclxuICAgICAgICBpZiAoZXZlbnQuZGF0YVRyYW5zZmVyICYmIGV2ZW50LmRhdGFUcmFuc2Zlci50eXBlc1swXSA9PT0gJ3RleHQvcGxhaW4nKSB7XHJcbiAgICAgICAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7ICAgXHJcbiAgICAgICAgICAgIGNvbnN0IGxpc3RFbCA9IHRoaXMuZWxlbWVudC5xdWVyeVNlbGVjdG9yKCd1bCcpITtcclxuICAgICAgICAgICAgbGlzdEVsLmNsYXNzTGlzdC5hZGQoJ2Ryb3BwYWJsZScpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBAQXV0b0JpbmRcclxuICAgIGRyYWdMZWF2ZUhhbmRsZXIoX2V2ZW50OiBEcmFnRXZlbnQpIHtcclxuICAgICAgICBjb25zdCBsaXN0RWwgPSB0aGlzLmVsZW1lbnQucXVlcnlTZWxlY3RvcigndWwnKSE7XHJcbiAgICAgICAgbGlzdEVsLmNsYXNzTGlzdC5yZW1vdmUoJ2Ryb3BwYWJsZScpO1xyXG4gICAgfVxyXG5cclxuICAgIEBBdXRvQmluZFxyXG4gICAgZHJvcEhhbmRsZXIoZXZlbnQ6IERyYWdFdmVudCkge1xyXG4gICAgICAgIGNvbnN0IHByaklkID0gZXZlbnQuZGF0YVRyYW5zZmVyIS5nZXREYXRhKCd0ZXh0L3BsYWluJyk7XHJcbiAgICAgICAgcHJvamVjdFN0b3JlLm1vdmVQcm9qZWN0KHByaklkLCB0aGlzLnR5cGUgPT09ICdhY3RpdmUnID8gUHJvamVjdFN0YXR1cy5BY3RpdmUgOiBQcm9qZWN0U3RhdHVzLkZpbmlzaGVkKTtcclxuICAgIH1cclxuXHJcbiAgICBjb25maWd1cmUoKSB7XHJcbiAgICAgICAgdGhpcy5lbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ2RyYWdvdmVyJywgdGhpcy5kcmFnT3ZlckhhbmRsZXIpO1xyXG4gICAgICAgIHRoaXMuZWxlbWVudC5hZGRFdmVudExpc3RlbmVyKCdkcmFnbGVhdmUnLCB0aGlzLmRyYWdMZWF2ZUhhbmRsZXIpO1xyXG4gICAgICAgIHRoaXMuZWxlbWVudC5hZGRFdmVudExpc3RlbmVyKCdkcm9wJywgdGhpcy5kcm9wSGFuZGxlcik7XHJcbiAgICAgICAgXHJcbiAgICAgICAgcHJvamVjdFN0b3JlLmFkZExpc3RlbmVyKChwcm9qZWN0czogUHJvamVjdFtdKSA9PiB7XHJcbiAgICAgICAgICAgIGNvbnN0IHJlbGV2ZW50UHJvamVjdHMgPSBwcm9qZWN0cy5maWx0ZXIocHJqID0+IHtcclxuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLnR5cGUgPT09ICdhY3RpdmUnID8gcHJqLnN0YXR1cyA9PT0gUHJvamVjdFN0YXR1cy5BY3RpdmUgOiBwcmouc3RhdHVzID09PSBQcm9qZWN0U3RhdHVzLkZpbmlzaGVkO1xyXG4gICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICB0aGlzLmFzc2lnbmVkUHJvamVjdHMgPSByZWxldmVudFByb2plY3RzO1xyXG4gICAgICAgICAgICB0aGlzLnJlbmRlclByb2plY3RzKCk7XHJcbiAgICAgICAgfSlcclxuICAgIH1cclxuXHJcbiAgICBwcml2YXRlIHJlbmRlclByb2plY3RzKCkge1xyXG4gICAgICAgIGNvbnN0IGxpc3RFbGVtZW50ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoYCR7dGhpcy50eXBlfS1wcm9qZWN0cy1saXN0YCkhIGFzIEhUTUxVTGlzdEVsZW1lbnQ7XHJcblxyXG4gICAgICAgIGxpc3RFbGVtZW50LmlubmVySFRNTCA9ICcnO1xyXG4gICAgICAgIGZvciAoY29uc3QgcHJvamVjdCBvZiB0aGlzLmFzc2lnbmVkUHJvamVjdHMpIHtcclxuICAgICAgICAgICAgbmV3IFByb2plY3RJdGVtKHRoaXMuZWxlbWVudC5xdWVyeVNlbGVjdG9yKCd1bCcpIS5pZCwgcHJvamVjdCk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgXHJcbiAgICByZW5kZXJDb250ZW50KCkge1xyXG4gICAgICAgIGNvbnN0IGxpc3RJZCA9IGAke3RoaXMudHlwZX0tcHJvamVjdHMtbGlzdGA7XHJcbiAgICAgICAgdGhpcy5lbGVtZW50LnF1ZXJ5U2VsZWN0b3IoJ3VsJykhLmlkID0gbGlzdElkO1xyXG4gICAgICAgIHRoaXMuZWxlbWVudC5xdWVyeVNlbGVjdG9yKCdoMicpIS50ZXh0Q29udGVudCA9IHRoaXMudHlwZS50b1VwcGVyQ2FzZSgpICsgJyBQUk9KRUNUUyc7XHJcbiAgICB9XHJcbn0iLCJpbXBvcnQgeyBQcm9qZWN0SW5wdXQgfSBmcm9tIFwiLi9Db21wb25lbnRzL3Byb2plY3QtaW5wdXRcIjtcclxuaW1wb3J0IHsgUHJvamVjdExpc3QgfSBmcm9tIFwiLi9Db21wb25lbnRzL3Byb2plY3QtbGlzdFwiO1xyXG5cclxubmV3IFByb2plY3RJbnB1dCgpO1xyXG5uZXcgUHJvamVjdExpc3QoJ2FjdGl2ZScpO1xyXG5uZXcgUHJvamVjdExpc3QoJ2ZpbmlzaGVkJyk7Il0sInNvdXJjZVJvb3QiOiIifQ==